\subsection{Finite Elasticity}
\label{subsec:FiniteElasticity}

%Deformation can be viewed three ways: A point to point transformation; A
%coordinate transformation; or as a transformation of metrics (convected coordinates).

\subsubsection{Kinematics}

As shown in \figref{fig:configurationsetting}, consider a \emph{material
  body} which is a three-dimensional smooth manifold with a boundary, $\manifold{B}$,
which consists of a set of points which are refered to as \emph{material
  points}. Consider also an ambient space manifold,
$\manifold{S}\in\rntopology{n}$. The material body is only accessible to
the observer when it moves through the ambient space. This motion is a
time-dependent embedding on the material body into the ambient space. The
embedding is known as a \emph{placement of the body}. It is given by the
mapping
\begin{equation}
  \mapping{\fnof{\kappa}{\mathcal{X},t}}{\manifold{B}}{\manifold{S}}
\end{equation}

The embedded submanifold occupying a location in the ambient space is is
called a \emph{configuration} of $\manifold{B}$ and is given by
\begin{equation}
  \embedmanifold{B}_{t}=\fnof{\kappa_{t}}{\manifold{B}}=\fnof{\kappa}{\manifold{B},t}
\end{equation}

The customary (but not necessary) \emph{reference placement} is given by
\begin{equation}
  \mapping{\kappa_{0}}{\manifold{B}}{\manifold{S}}
\end{equation}
and the region of space occupied by the reference placement \ie the
\emph{reference configuration} is given by
\begin{equation}
  \embedmanifold{B}_{0}=\fnof{\kappa_{0}}{\manifold{B}}
\end{equation}
Points in $\embedmanifold{B}_{0}$ are denoted by capital letters \ie $X, Y,
\ldots$. Points in $\embedmanifold{B}$ are denoted by lower case leters \ie
$x, y, \dots$.

\epstexfigure{svgs/EquationSets/Elasticity/FiniteElasticity/setup.eps_tex}{}{}{fig:configurationsetting}{0.75}

A new configuration of $\manifold{B}$ is given by the deformation mapping
\begin{equation}
  \mapping{\chi}{\embedmanifold{B}}{\rntopology{3}}
\end{equation}
where a configuration represents a deformed state of the body. As the body
moves we obtain a family of configurations. If we hold $X\in\embedmanifold{B}$
fixed can write $\fnof{V_{t}}{X}=\fnof{V}{X,t}$. We then have
\begin{equation}
  \fnof{V_{t}}{X}=\fnof{V}{X,t}=\delby{\fnof{\chi}{X,t}}{t}=\dby{\fnof{\chi_{X}}{t}}{t}
\end{equation}

Here $V_{t}$ is called the \emph{material velocity} of the motion. The
\emph{material acceleration} of the body is defined as
\begin{equation}
  \fnof{A_{t}}{X}=\fnof{A}{X,t}=\delby{\fnof{V}{X,t}}{t}=\dby{\fnof{V_{X}}{t}}{t}
\end{equation}

The \emph{spatial velocity} of the motion is defined by $v_{t}$ and the
\emph{spatial acceleration} of the motion is defined by $a_{t}$.

FIX BELOW

Consider the following line, area and volume forms in the reference configuration given by
\begin{align}
  \exteriorderiv{\covectr{X}}&=\sqrt{\det{G_{IJ}}}dX^{1} \\
  \exteriorderiv{V}&=\sqrt{\det{G_{IJ}}}\wedgeprod{\wedgeprod{dX^{1}}{dX^{2}}}{dX^{3}}
\end{align}
the corresponding volume form in the current configuration
\begin{equation}
  \exteriorderiv{\covectr{v}}=\sqrt{\det{g_{ij}}}\wedgeprod{\wedgeprod{dx^{1}}{\cdots}}{dx^{n}}
\end{equation}
is given by
\begin{equation}
  \pullback{\chi}{\exteriorderiv{\covectr{v}}}=J\exteriorderiv{\covectr{V}}
\end{equation}
where $J$ is the \emph{Jacobian} of the mapping and is given by
\begin{equation}
  \fnof{J}{X}=\sqrt{\dfrac{\det{g_{ij}}}{\det{G_{IJ}}}}\det{\pbrac{\delby{\fnof{\chi^{i}}{X}}{X^{I}}}}
\end{equation}

\subsubsection{Deformation Gradient}

Let
$\mapping{\chi}{\embedmanifold{B}_{0}}{\fnof{\chi}{\embedmanifold{B}_{0}}\subset\manifold{S}}$
be a deformation configuration of $\embedmanifold{B}$ in $\manifold{S}$. The
tangent of the mapping \ie $\tangentbundle{\chi}$ is denoted as $\tensor{F}$
and is called the \emph{deformation gradient} of $\chi$ \ie
$\tensor{F}=\tangentbundle{\chi}$. For $X\in\embedmanifold{B}_{0}$ we
have\symbolat{$\tensortwo{F}$}{Deformation gradient tensor}
\begin{equation}
  \tensor{F}_{X}=\mapping{\fnof{\tensor{F}}{X}}{\tangentspace{\embedmanifold{B}_{0}}{X}}{\tangentspace{\manifold{S}}{\fnof{\chi}{X}}}
\end{equation}
 
If $X^{I}$ and $x^{i}$ are the coordinates on $\embedmanifold{B}_{0}$ and
$\manifold{S}$ then the deformation gradient tensor with respect to the
coordinate bases are
\begin{equation}
  \fnof{\tensor{F}}{X}=\fnof{F^{i}_{I}}{X}\tensorprod{\vectr{G}^{I}}{\vectr{g}_{i}}=\delby{\fnof{\chi^{i}}{X}}{X^{I}}\tensorprod{\vectr{G}^{I}}{\vectr{g}_{i}}
\end{equation}

Note that $\tensor{F}$ is a two-point tensor. 

The polar decomposition

\begin{diagram}
 & & \tangentspace{B}{X} & & \\
 & \ruTo^{\tensor{U}} & & \rdTo^{\tensor{R}} \\
\tangentspace{B}{X} & & \rTo^{\tensor{F}} & & \tangentspace{S}{x}\\
 & \rdTo_{\tensor{R}} & & \ruTo_{\tensor{V}} \\
 & &  \tangentspace{S}{x} & &
\end{diagram}

is given by
\begin{equation}
  \tensor{F}=\dotprod{\tensor{R}}{\tensor{U}}=\dotprod{\tensor{V}}{\tensor{R}}
\end{equation}
where $\tensor{U}$ is the \emph{right stretch tensor}, $\tensor{V}$ is the
\emph{left stretch tensor} and $\tensor{R}$ is the \emph{rotation
  tensor}.\symbolat{$\tensor{U}$}{Right stretch
  tensor}\symbolat{$\tensor{V}$}{Left stretch
  tensor}\symbolat{$\tensor{R}$}{Rotation tensor}

If we let the deformed coordinates be given by the position vector,
$\fnof{\vectr{z}}{\vectr{x},t}$ then the deformation gradient tensor with
respect to the undeformed $\vectr{X}$ coordinates is given by
\begin{equation}
  \fnof{\tensor{F}}{\vectr{X}}=\delby{\vectr{z}}{\vectr{X}}
\end{equation}
or, in component form,
\begin{equation}
  F^{i}_{I}=\delby{z^{i}}{X^{I}}=\delby{z^{i}}{\xi^{r}}\delby{\xi^{r}}{X^{I}}
\end{equation}

The deformation gradient tensor can also be used to map lines, area and volume forms
between the reference and current configurations and vice versa \ie
\begin{align}
  \exteriorderiv{\covectr{x}} &= \tensor{F}\exteriorderiv{\covectr{X}} \\
  \exteriorderiv{\covectr{a}} &= J\invtranspose{\tensor{F}}\exteriorderiv{\covectr{A}} \\
  \exteriorderiv{v} &= J\exteriorderiv{V}
\end{align}
where $\exteriorderiv{\covectr{X}}$, $\exteriorderiv{\covectr{A}}$ and
$\exteriorderiv{V}$ are the line, area and volume forms in the reference
configuration and $\exteriorderiv{\covectr{x}}$, $\exteriorderiv{\covectr{a}}$ and
$\exteriorderiv{v}$ are the line, area and volume forms in the current
configuration. $J$ is the \emph{Jacobian} and is given by
\begin{equation}
  J=\sqrt{\dfrac{\det{\tensor{g}}}{\det{\tensor{G}}}}\det{\tensor{F}}
\end{equation}

The formula for mapping areas is known as \emph{Nanson's formula} and is
given by
\begin{equation}
  \covectr{n}\exteriorderiv{\covectr{a}}=J\pushforward{\chi}{\covectr{N}\exteriorderiv{\covectr{A}}}
\end{equation}
or
\begin{equation}
  \covectr{n}\exteriorderiv{\covectr{a}}=J\invtranspose{\tensor{F}}\covectr{N}\exteriorderiv{\covectr{A}}
\end{equation}
where $\covectr{N}$ and $\exteriorderiv{\covectr{A}}$ are the unit normal and
area form in the reference configuration,  $\covectr{n}$ and $\exteriorderiv{\covectr{a}}$ are the unit normal and
area form in the current configuration and $J$ is the Jacobian. 
  
\subsubsection{Strain and deformation tensors}

Strain and deformation tensors quantify the amount of strain or deformation
\ie the amount of stretch or distance between material points.  

There are three strain tensors in the \emph{material} coordinate system. The
\emph{right Cauchy-Green (or Green) deformation tensor}, $\tensor{C}$, is
defined by\symbolat{$\tensortwo{C}$}{Right Cauchy-Green (or Green) deformation
  tensor}
\begin{equation}
  \mapping{\fnof{\tensor{C}}{X}}{\tangentspace{\embedmanifold{B}}{X}}{\tangentspace{\embedmanifold{B}}{X}}
\end{equation}
as the pullback of the spatial metric tensor \ie $\fnof{\tensor{C}}{X}=\transpose{\fnof{\tensor{F}}{X}}\fnof{\tensor{g}}{x}\fnof{\tensor{F}}{X}$
or $\tensor{C}=\transpose{\tensor{F}}\tensor{g}\tensor{F}$ where $x=\fnof{\chi}{X}$. In terms of coordinates we
have
\begin{equation}
  \tensor{C}=C_{IJ}\tensorprod{\vectr{G}^{I}}{\vectr{G}^{J}}=g_{ij}F^{i}_{I}F^{j}_{J}\tensorprod{\vectr{G}^{I}}{\vectr{G}^{J}}
\end{equation}

If $\tensor{C}$ is invertible we also have $\tensor{B}=\inverse{\tensor{C}}$
where $\tensor{B}$ is called the \emph{Piola deformation
  tensor}.\symbolat{$\tensortwo{B}$}{Piola deformation tensor}

We also have the \emph{Green-Lagrange strain tensor} is given by the difference
in metric tensors\symbolat{$\tensortwo{E}$}{Green-Lagrange strain tensor}
\begin{equation}
  \fnof{\tensor{E}}{X}=\frac{1}{2}\pbrac{\fnof{\tensor{C}}{X}-\tensor{G}}
\end{equation}
of, in component form
\begin{equation}
  \tensor{E}=E_{IJ}\tensorprod{\vectr{G}^{I}}{\vectr{G}^{J}}=\frac{1}{2}\pbrac{C_{IJ}-G_{IJ}}\tensorprod{\vectr{G}^{I}}{\vectr{G}^{J}}
\end{equation}

There are also three strain tensors in the \emph{spatial} coordinate
sytsem. The \emph{left Cauchy-Green (or Finger) deformation tensor},
$\tensor{b}$, is defined by\symbolat{$\tensortwo{b}$}{Left Cauchy-Green (or
  Finger) deformation tensor}
\begin{equation}
  \mapping{\fnof{\tensor{b}}{x}}{\tangentspace{\fnof{\chi}{\embedmanifold{B}}}{x}}{\tangentspace{\fnof{\chi}{\embedmanifold{B}}}{x}}
\end{equation}
as the push forward of the material metric tensor \ie
$\fnof{\tensor{b}}{x}=\fnof{\tensor{F}}{X}\fnof{\tensor{G}}{X}\transpose{\fnof{\tensor{F}}{X}}$
or $\tensor{b}=\tensor{F}\tensor{G}\transpose{\tensor{F}}$ where
$X=\fnof{\inverse{\chi}}{x}$. In terms of coordinates we have
\begin{equation}
  \tensor{b}=b^{ij}\tensorprod{\vectr{g}_{i}}{\vectr{g}_{j}}=G^{IJ}F^{i}_{I}F^{j}_{J}\tensorprod{\vectr{g}_{i}}{\vectr{g}_{j}}
\end{equation}

The left and right Cauchy-Green deformation tensors get their left and right
names from their relationship to the left and right stretch tensors \ie in
cartesian coordinates
\begin{equation}
  \tensor{U}=\sqrt{\tensor{C}}
\end{equation}
and
\begin{equation}
  \tensor{V}=\sqrt{\tensor{b}}
\end{equation}

We also have $\tensor{c}=\inverse{\tensor{b}}$ where $\tensor{c}$ is the
\emph{Cauchy deformation tensor} \ie \symbolat{$\tensor{c}$}{Cauchy deformation tensor}
\begin{equation}
	  \tensor{c}=c_{ij}\tensorprod{\vectr{g}^{i}}{\vectr{g}^{j}}
\end{equation}

The final spatial strain tensor is the \emph{Euler-Almansi strain tensor},
$\tensor{e}$, is defined as the difference in metrics
by\symbolat{$\tensor{e}$}{Euler-Almansi strain tensor}
\begin{equation}
  \mapping{\fnof{\tensor{e}}{x}}{\tangentspace{\fnof{\chi}{\embedmanifold{B}}}{x}}{\tangentspace{\fnof{\chi}{\embedmanifold{B}}}{x}}
\end{equation}
and
\begin{equation}
  \begin{split}
    \fnof{\tensor{e}}{x}&=\frac{1}{2}\pbrac{\tensor{g}-\inverse{\fnof{\tensor{b}}{x}}}\\
    &= \frac{1}{2}\pbrac{\tensor{g}-\fnof{\tensor{c}}{x}}
  \end{split}
\end{equation}
where $\tensor{c}=\inverse{\tensor{b}}$. In component form we have
\begin{equation}
  \tensor{e}=e_{ij}\tensorprod{\vectr{g}^{i}}{\vectr{g}^{j}}=\frac{1}{2}\pbrac{g_{ij}-c_{ij}}\tensorprod{\vectr{g}^{i}}{\vectr{g}^{j}}
\end{equation}

Note that we have the following relationships between the deformation tensors
and metric tensors
\begin{alignat}{7}
  \flattensor{\tensor{C}}&=&\pullback{\chi}{\flattensor{\tensor{g}}} &\quad&
  \flattensor{\tensor{c}}&=&\pushforward{\chi}{\flattensor{\tensor{G}}} \\
  \sharptensor{\tensor{B}}&=&\pullback{\chi}{\sharptensor{\tensor{g}}} &\quad&
  \sharptensor{\tensor{b}}&=&\pushforward{\chi}{\sharptensor{\tensor{G}}} \\
  \flattensor{\tensor{E}}&=&\pullback{\chi}{\flattensor{\tensor{e}}} &\quad&
  \flattensor{\tensor{e}}&=&\pushforward{\chi}{\flattensor{\tensor{E}}} \\ 
  &=&\frac{1}{2}\pbrac{\pullback{\chi}{\flattensor{\tensor{g}}}-\flattensor{\tensor{G}}}&\quad&
  &=&\frac{1}{2}\pbrac{\flattensor{\tensor{g}}-\pushforward{\chi}{\flattensor{\tensor{G}}}}
\end{alignat}
\ie
\begin{alignat}{7}
  \flattensor{\tensor{C}}&=&\transpose{\tensor{F}}\flattensor{\tensor{g}}\tensor{F} &\quad&
  \flattensor{\tensor{c}}&=&\invtranspose{\tensor{F}}\flattensor{\tensor{G}}\inverse{\tensor{F}} \\
  \sharptensor{\tensor{B}}&=&\inverse{\tensor{F}}\sharptensor{\tensor{g}}\invtranspose{\tensor{F}} &\quad&
  \sharptensor{\tensor{b}}&=&\tensor{F}\sharptensor{\tensor{G}}\transpose{\tensor{F}} \\
  \flattensor{\tensor{E}}&=&\transpose{\tensor{F}}\flattensor{\tensor{e}}\tensor{F} &\quad&
  \flattensor{\tensor{e}}&=&\invtranspose{\tensor{F}}\flattensor{\tensor{E}}\inverse{\tensor{F}}   
\end{alignat}
or, in component form,
\begin{alignat}{3}
  C_{IJ}=g_{ij}F^{i}_{I}F^{j}_{J} &\quad& 
  c_{ij}=G_{IJ}\pbrac{\inverse{F}}^{I}_{i}\pbrac{\inverse{F}}^{J}_{j} \\
  B^{IJ}=g^{ij}\pbrac{\inverse{F}}^{I}_{i}\pbrac{\inverse{F}}^{J}_{j} &\quad&
  b^{ij}=G^{IJ}F^{i}_{I}F^{j}_{J} \\
  E_{IJ}=e_{ij}F^{i}_{I}F^{j}_{J} &\quad&
  e_{ij}=E_{IJ}\pbrac{\inverse{F}}^{I}_{i}\pbrac{\inverse{F}}^{J}_{j}   
\end{alignat}

\subsubsection{Stress tensors}

Stress is amount of force over an area. We can thus form a number of different
stress tensors depending on what configuration we base the force and the area
in.

The \emph{Cauchy stress tensor}, $\tensor{\sigma}$, has both the force and
area referred to the \emph{spatial} configuration. The Cauchy stress tensor is
important as it quantifies the physical stress that exists in current
configuration and can be measured. It is defined by\symbolat{\tensortwo{\sigma}}{Cauchy stress tensor}
\begin{equation}
  \mapping{\fnof{\tensor{\sigma}}{x}}{\spaceprod{\tangentspace{\embedmanifold{B}}{x}}{\tangentspace{\embedmanifold{B}}{x}}}{\realnums}
\end{equation}
\ie
\begin{equation}
  \fnof{\tensor{\sigma}}{x}=\sigma^{ij}\tensorprod{\vectr{g}_{i}}{\vectr{g}_{j}}
\end{equation}

Cauchy's law....

We can also define the \emph{Kirchoff stress tensor}, $\tensor{\tau}$, by
scaling the Cauchy stress by the Jacobian \ie\symbolat{\tensortwo{\tau}}{Kirchoff stress tensor}
\begin{equation}
  \tensor{\tau}=J\tensor{\sigma}
\end{equation}

To find other stress measures we need to make use of Piola's transform and
idenity.

The \emph{Piola transform} allows mapping of vector fields on the current
configuration to equivalent vector fields in the reference configuration. The
transform is given by
\begin{equation}
  \vectr{Y}=J\pullback{\chi}{\vectr{y}}=J\inverse{\tensor{F}}\vectr{y}
\end{equation}
where $\vectr{y}$ is the vector field on the current configuration and
$\vectr{Y}$ is the equivalent vector field on the reference configuration. In
component form we have
\begin{equation}
  Y^{I}=J\pbrac{\inverse{F}}^{I}_{i}y^{i}
\end{equation}

Now if $\vectr{Y}$ is the Piola transform of $\vectr{y}$ then we have the
\emph{Piola identity} given by
\begin{equation}
  \Divop{\vectr{Y}}=J\divop{\circcomposition{\vectr{y}}{\chi}}
\end{equation}
where $\Divop$ is the divergence operator in the reference configuration and
$\divop$ is the divergence operator in the current configurtion. 

Using the Piola transform we can construct two new stress tensors. If we apply
the Piola transform to the second index of the Cauchy stress tensor we obtain
the \emph{First Piola-Kirchoff Stress Tensor} \ie\symbolat{\tensortwo{P}}{First Piola-Kirchoff stress tensor}
\begin{equation}
  \tensor{P}=J\invtranspose{\tensor{F}}\tensor{\sigma}
\end{equation}
or, in component form,
\begin{equation}
  \tensor{P}=P^{iI}\tensorprod{\vectr{g}_{i}}{\vectr{G}_{I}}=J\pbrac{\inverse{F}}^{I}_{j}\sigma^{ij}\tensorprod{\vectr{g}_{i}}{\vectr{G}_{I}}
\end{equation}

The first Piola-Kirchoff stress tensor relates forces in the current
configuration with areas in the reference configuration. Note that
$\tensor{P}$ is a two point tensor and is not symmetric.

The relationship between Cauchy stress and the First Piola-Kirchoff stress is
given by
\begin{equation}
  \tensor{\sigma}=\inverse{J}\tensor{P}\transpose{\tensor{F}}
\end{equation}

If we now apply the Piola transform to the first index of the First Piola-Kirchoff stress tensor we obtain
the \emph{Second Piola-Kirchoff Stress Tensor} \ie\symbolat{\tensortwo{S}}{Second Piola-Kirchoff stress tensor}
\begin{equation}
  \tensor{S}=J\inverse{\tensor{F}}\tensor{P}
\end{equation}
or, in terms of the Cauchy stress,
\begin{equation}
  \tensor{S}=J\inverse{\tensor{F}}\tensor{\sigma}\invtranspose{\tensor{F}}
\end{equation}
or, in terms of components
\begin{equation}
  \tensor{S}=S^{IJ}\tensorprod{\vectr{G}_{I}}{\vectr{G}_{J}}=J\pbrac{\inverse{F}}^{I}_{i}\pbrac{\inverse{F}}^{J}_{j}\sigma^{ij}\tensorprod{\vectr{G}_{I}}{\vectr{G}_{J}}
\end{equation}

The second Piola-Kirchoff stress tensor relates forces in the reference
configuration with areas in the reference configuration.

Note that the Kirchoff stress is just the push forward of the second
Piola-Kirchoff stress \ie
\begin{equation}
  \tensor{\tau}=\tensor{F}\tensor{S}\transpose{\tensor{F}}
\end{equation}
and
\begin{equation}
  \tensor{S}=\inverse{\tensor{F}}\tensor{\tau}\invtranspose{\tensor{F}}
\end{equation}

BIOT STRESS

COVECTED STRESSS


The relationships between the stress tensors are given in \Tabref{tab:RelationshipBetweenStressTensors}.

\begin{table}[htb] \centering
  \begin{tabular}{|c|c|c|c|c|} \hline
    & $\tensor{\sigma}$ & $\tensor{\tau}$ & $\tensor{P}$ & $\tensor{S}$
    \\ \hline \hline
    $\tensor{\sigma}$ & - & $\inverse{J}\tensor{\tau}$ &
    \inverse{J}\tensor{P}\transpose{\tensor{F}} &
    \inverse{J}\tensor{F}\tensor{S}\transpose{\tensor{F}}\\
    $\tensor{\tau}$ & $J\tensor{\sigma}$ & - &
    \tensor{P}\transpose{\tensor{F}} &
    \tensor{F}\tensor{S}\transpose{\tensor{F}} \\
    $\tensor{P}$ & $J\tensor{\sigma}\invtranspose{\tensor{F}}$ &
    \tensor{\tau}\invtranspose{\tensor{F}} & - & \tensor{F}\tensor{S} \\
    $\tensor{S}$ &
    J\inverse{\tensor{F}}\tensor{\sigma}\invtranspose{\tensor{F}} &
    \inverse{\tensor{F}}\tensor{\sigma}\invtranspose{\tensor{F}} &
    \inverse{\tensor{F}}\tensor{P} & - \\ \hline
  \end{tabular}
  \caption{Reltionships between stress tensors.}
  \label{tab:RelationshipBetweenStressTensors}
\end{table}

For incompressible materials we need an additional volumetric stress. The
\emph{hydrostatic stress} is a Cauchy stress and so we have
\begin{equation}
  \tensor{\sigma}_{p}=-p\tensor{g}
\end{equation}
or in component form
\begin{equation}
  \tensor{\sigma}_{p}=\sigma^{ij}_{p}\tensorprod{\vectr{g}_{i}}{\vectr{g}_{j}}=-pg^{ij}\tensorprod{\vectr{g}_{i}}{\vectr{g}_{j}}
\end{equation}
where $p$ is known as the \emph{hydrostatic pressure}.

We can pull this stress back to give a second Piola-Kirchoff stress via the
pullback operation for a second order tensor \ie
\begin{equation}
  \tensor{S}_{p}=J\inverse{\tensor{F}}\tensor{\sigma}_{p}\invtranspose{\tensor{F}}=-pJ\inverse{\tensor{C}}
\end{equation}
or, in component form,
\begin{equation}
  \tensor{S}_{p}=S^{IJ}_{p}\tensorprod{\vectr{G}_{I}}{\vectr{G}_{J}}=-JF^{I}_{i}pg^{ij}F^{J}_{j}\tensorprod{\vectr{G}_{I}}{\vectr{G}_{J}}=-pJ\pbrac{\inverse{C}}^{IJ}\tensorprod{\vectr{G}_{I}}{\vectr{G}_{J}}
\end{equation}

RESTRICTIONS ON STRESS TENSOR E.G. SYMMETRY

\subsubsection{Constituative Relationships}

The relationship between stress and strain is known as a \emph{consituative
  relationship}. Materials for which the constituative relationship is just a
function of the current state of deformation are known as \emph{elastic}.

\subsubsubsection{Hyperelasticity}

For the special case whereby the work done by stresses during deformation is
just a function of the initial configuration and the current configuration are
known as \emph{hyperelastic}. As a consequence hyperelastic materials are
independent of the path of deformation and just depend on a \emph{stored
  energy function} or \emph{elastic potential}, $\psi$.

WORK CONJUGATES: P and F, S and C/E.

The first Piola-Kirchoff stress tensor is thus a function of postion and the
deformation gradient tensor \ie
\begin{equation}
  \tensor{P}=\fnof{\tensor{P}}{\vectr{X},\fnof{\tensor{F}}{\vectr{X}}}
\end{equation}

In terms of the stored energy function we have
\begin{equation}
  \fnof{\tensor{P}}{\vectr{X}}=\delby{\fnof{\psi}{\fnof{\tensor{F}}{\vectr{X}},\vectr{X}}}{\fnof{\tensor{F}}{\vectr{X}}}
\end{equation}
or, in component form,
\begin{equation}
  \tensor{P}=P^{iI}\tensorprod{\vectr{g}_{i}}{\vectr{G}_{I}}=\delby{\psi}{F^{i}_{I}}\tensorprod{\vectr{g}_{i}}{\vectr{G}_{I}}
\end{equation}
ABOVE IS NOT RIGHT IN TERMS OF POSITION OF INDICES.

The second Piola-Kirchoff stress tensor is thus a function of position and
the right Cauchy-Green deformation tensor (or, equivalently, the
Green-Lagrange strain tensor) \ie
\begin{equation}
  \tensor{S}=\fnof{\tensor{S}}{\vectr{X},\fnof{\tensor{C}}{\vectr{X}}}
\end{equation}



\subsubsubsection{Viscoelasticity}

\subsubsubsection{Plasticity}


\subsubsection{Anisotropy}

In order to deal with anisotropy we wish to base our stress and strain
calculation on fibre, $\vectr{\nu}$, coordinates. To change our reference
coordinate system from $\vectr{X}$ to $\vectr{\nu}$ we need to transform
$\fnof{\tensor{F}}{\vectr{X}}$. As $\fnof{\tensor{F}}{\vectr{X}}$ is a two point tensor the transformation
rule for transforming just the reference coordinates is given by
\begin{equation}
\fnof{\tensor{F}}{\vectr{\nu}}=\tensor{Q}\fnof{\tensor{F}}{\vectr{X}}
\end{equation}
where $\tensor{Q}$ is the rotation matrix from $\vectr{X}$ to $\vectr{\nu}$ \ie
\begin{equation}
  F^{i}_{A}=\delby{X^{M}}{\nu^{A}}F^{i}_{M}=\delby{X^{M}}{\nu^{A}}\delby{z^{i}}{\xi^{k}}\delby{\xi^{k}}{X^{M}}
\end{equation}

To allow for growth we use a multiplicative decomposition approach \ie
\begin{equation}
  \fnof{\tensor{F}}{\vectr{\nu}}=\fnof{\tensor{F}_{e}}{\vectr{\nu}}\fnof{\tensor{F}_{g}}{\vectr{\nu}}
\end{equation}
where $\fnof{\tensor{F}_{g}}{\vectr{\nu}}$ is the growth tensor with
respect to fibre coordinates and $\fnof{\tensor{F}_{e}}{\vectr{\nu}}$ is the
elastic component of the deformation gradient tensor in fibre coordinates.

The elastic component of the deformation gradient tensor can be calculated
from
\begin{equation}
  \fnof{\tensor{F}_{e}}{\vectr{\nu}}=\fnof{\tensor{F}}{\vectr{\nu}}\fnof{\inverse{\tensor{F}_{g}}}{\vectr{\nu}}
\end{equation}

In component form we have
\begin{equation}
  F^{i}_{A}=\pbrac{F_{e}}^{i}_{B}\pbrac{F_{g}}^{B}_{A}
\end{equation}
and
\begin{equation}
  \pbrac{F_{e}}^{i}_{B}=F^{i}_{A}\pbrac{\inverse{F_{g}}}^{A}_{B}
\end{equation}

The Jacobian of the growth component of the deformation is given by
$J_{g}=\det{\fnof{\tensor{F}_{g}}{\vectr{\nu}}}$ and the Jacobian of the
elastic component of the deformation is given by
$J_{e}=\det{\fnof{\tensor{F}_{e}}{\vectr{\nu}}}$.

The right Cauchy Green deformation tensor in fibre coordinates is now given by
the pullback of the current configuration metric tensor, $\tensor{g}$,
\begin{equation}
  \fnof{\tensor{C}}{\vectr{\nu}}=\fnof{\transpose{\tensor{F}_{e}}}{\vectr{\nu}}\tensor{g}\fnof{\tensor{F}_{e}}{\vectr{\nu}}
\end{equation}

In component form we have
\begin{equation}
  C_{AB}=g_{ij}\pbrac{F_{e}}^{i}_{A}\pbrac{F_{e}}^{j}_{B}
\end{equation}
and
\begin{equation}
  E_{AB}=\frac{1}{2}\pbrac{C_{AB}-G_{AB}}
\end{equation}

To find the stress tensors in deformed coordinates we need to push the second
Piola Kirchhoff tensor in the reference coordinates forward to the deformed
coordinates, $\vectr{x}$, to give the Kirchhoff stress tensor,
$\fnof{\tensor{\tau}}{\vectr{x}}$. The push foward is given by
\begin{equation}
  \fnof{\tensor{\tau}}{\vectr{x}}=\fnof{\tensor{F}_{e}}{\vectr{\nu}}\fnof{\tensor{S}}{\vectr{\nu}}
  \fnof{\transpose{\tensor{F}_{e}}}{\vectr{\nu}}
\end{equation}

The Cauchy stress tensor, $\fnof{\tensor{\sigma}}{\vectr{x}}$, can then be calculated from the Kirchhoff stress
tensor using the Jacobian of the deformation \ie
\begin{equation}
  \fnof{\tensor{\sigma}}{\vectr{x}}=\inverse{J_{e}}\fnof{\tensor{\tau}}{\vectr{x}}=\inverse{J_{e}}
  \fnof{\tensor{F}_{e}}{\vectr{\nu}}\fnof{\tensor{S}}{\vectr{\nu}}\fnof{\transpose{\tensor{F}_{e}}}{\vectr{\nu}}
\end{equation}7

In component form we have
\begin{equation}
  \tau^{ij}=\pbrac{F_{e}}^{i}_{B}T^{BC}\pbrac{\transpose{F_{e}}}^{j}_{C}
\end{equation}
and
\begin{equation}
  \sigma^{ij}=\inverse{J_{e}}\pbrac{F_{e}}^{i}_{B}T^{BC}\pbrac{\transpose{F_{e}}}^{j}_{C}
\end{equation}


\subsubsection{Elasticity Tensors}

If $\fnof{\tensor{P}}{\vectr{X},\tensor{F}}$ is the first Piola-Kirchoff
constituative function that depends on $\vectr{X}$ and the deformation
gradient tensor $\tensor{F}$. The \emph{first elasticity tensor},
$\tensorfour{A}$, is given by \symbolat{$\tensorfour{A}$}{First elasticity
  tensor}
\begin{equation}
  \tensorfour{A}=\delby{\tensor{P}}{\tensor{F}}
\end{equation}
or
\begin{equation}
  A^{iAB}_{j}=\delby{P^{iA}}{F^{j}_{B}}
\end{equation}

Note that $\tensorfour{A}$ is a two-point tensor. 

If $\fnof{\tensor{S}}{\vectr{X},\tensor{C}}$ is the second Piola-Kirchoff
constitutive function that depends on $\vectr{X}$ and the right Cauchy-Green
strain tensor $\tensor{C}$. The \emph{second elasticity tensor},
$\tensorfour{C}$, is given by \symbolat{$\tensorfour{C}$}{Second elasticity
  tensor}
\begin{equation}
  \tensorfour{C}=\delby{\tensor{S}}{\tensor{C}}
\end{equation}
or
\begin{equation}
  C^{ABCD}=\delby{S^{AB}}{C_{CD}}
\end{equation}

We can derive a relationship between $\tensorfour{A}$ and $\tensorfour{C}$. Differentiating
\begin{equation}
  \tensor{P}=\tensor{F}\tensor{S}
\end{equation}
or
\begin{equation}
  P^{iA}=F^{i}_{B}S^{BA}
\end{equation}
with respect to the deformation gradient tensor gives
\begin{equation}
  \delby{P^{iA}}{F^{j}_{B}}=F^{i}_{C}\delby{S^{CA}}{C_{DE}}\delby{C_{DE}}{F^{i}_{C}}+\delby{F^{i}_{C}}{F^{j}_{B}}T^{CA}
\end{equation}

Now
\begin{equation}
  C_{DE}=F^{l}_{D}F^{k}_{E}g_{lk}
\end{equation}
and so
\begin{equation}
  \delby{C_{DE}}{F^{j}_{B}}=\mixedkronecker{D}{B}F^{k}_{E}g_{jk}+F^{l}_{D}\mixedkronecker{E}{B}g_{lj}
\end{equation}

Substituting this into the above equation gives
\begin{equation}
  \begin{split}
    \delby{P^{iA}}{F^{j}_{B}}&=C^{CADE}\pbrac{\mixedkronecker{D}{B}F^{k}_{E}g_{jk}+
      F^{l}_{D}\mixedkronecker{E}{B}g_{lj}}F^{i}_{C}+T^{CA}\mixedkronecker{i}{j}\mixedkronecker{C}{B}\\
    &=C^{CABE}F^{k}_{E}F^{i}_{C}g_{jk}+C^{CADE}F^{l}_{D}F^{i}_{C}g_{lj}+T^{BA}\mixedkronecker{j}{i}
  \end{split}
\end{equation}

Now, using the symmetries $C^{CABE}=C^{CAEB}$ and $T^{AB}=T^{BA}$ we have
\begin{equation}
  \tensorfour{A}=2\dotprod{\tensorfour{C}}{\dotprod{\tensortwo{F}}{\dotprod{\tensortwo{F}}{\tensortwo{g}}}}+
  \tensorprod{\tensortwo{S}}{\tensortwo{I}}
\end{equation}
or
\begin{equation}
  A^{iAB}_{j}=2C^{CADB}F^{k}_{D}F^{i}_{C}g_{kj}+T^{AB}\mixedkronecker{j}{i}
\end{equation}

Now, we can also define the \emph{first spatial elasticity tensor},
$\tensorfour{a}$, and the \emph{second spatial elasticity tensor},
$\tensorfour{c}$, using push forwards and Piola transforms of $\tensorfour{A}$
and $\tensorfour{C}$ respectively \ie\symbolat{$\tensorfour{a}$}{First spatial
elasticity tensor}\symbolat{$\tensorfour{c}$}{Second spatial elasticity
tensor}
\begin{equation}
  \begin{split}
    \tensorfour{a}&=\frac{1}{J}\pushforward{\chi}\tensorfour{A} \\
    \tensorfour{c}&=\frac{2}{J}\pushforward{\chi}\tensorfour{C} \\
  \end{split}
\end{equation}
or
\begin{equation}
  \begin{split}
    a^{ikl}_{j}&=\frac{1}{J}F^{k}_{A}F^{l}_{B}A^{iAB}_{j} \\
    c^{ijkl}&=\frac{2}{J}F^{i}_{A}F^{j}_{B}F^{k}_{C}F^{l}_{D}C^{ABCD} \\
  \end{split}
\end{equation}

The relationship between $\tensorfour{a}$ and $\tensorfour{c}$ is given by
\begin{equation}
  \tensorfour{a}=2\dotprod{\tensorfour{c}}{\tensortwo{g}}+\tensorprod{\tensortwo{\sigma}}{\tensortwo{I}}
\end{equation}
or
\begin{equation}
  a^{ikl}_{j}=c^{ikml}g_{mj}+\sigma^{kl}\mixedkronecker{j}{i}
\end{equation}

There is also a relationship between $\tensorfour{A}$ and $\tensorfour{a}$
known as the \emph{Piola identity} \ie
\begin{equation}
  \divergence{\vectr{X}}{\pbrac{\dotprod{\tensorfour{A}}{\vectr{U}}}}=
  J\divergence{\vectr{x}}{\pbrac{\dotprod{\tensorfour{a}}{\vectr{u}}}}
\end{equation}
where
\begin{equation}
  \vectr{u}=\pushforward{\chi}{\vectr{U}}
\end{equation}

Note that the tensor $\tensorfour{c}$ is different to $\tensorfour{C}$ in that
it is \emph{not} given by $\delby{\sigma^{ij}}{c_{kl}}$ and $\sigma^{ij}\neq
2\delby{W}{c_{ij}}$. They are instead given by
\begin{equation}
  c^{ijkl}=\delby{\sigma^{ij}}{g_{kl}}
\end{equation}
and
\begin{equation}
  \sigma^{ij}=2\delby{W}{g_{ij}}
\end{equation}

\subsection{Principle of Virtual Work}

Consider a configuration, defined by a displacement field $\vectr{u}$, of some
deformable body, $\embedmanifold{B}$, subject to some \emph{displacement
  boundary conditions} $\vectr{u}=\bar{\vectr{u}}$ over some part of the
boundary $\boundary{\embedmanifold{B}}_{u}$ and some \emph{traction boundary
  conditions} $\vectr{t}=\dotprod{\tensor{\sigma}}{\vectr{n}}=\bar{\vectr{t}}$
over some part of the boundary $\boundary{\embedmanifold{B}}_{t}$. Note that
$\intersection{\boundary{\embedmanifold{B}}_{u}}{\boundary{\embedmanifold{B}}_{t}}=\emptyset$
and
$\union{\boundary{\embedmanifold{B}}_{u}}{\boundary{\embedmanifold{B}}_{t}}\subseteq\boundary{\embedmanifold{B}}$.

We wish to find the displacement field $\vectr{u}$ which satisfies the
deformation boundary conditions where they are applied and the equations of
motion and the traction boundary conditions where they are applied. A
displacement field $\vectr{u}$ which satisfies the displacemnet boundary
conditions where they are applied but whose resulting stress field does not
necessarily satisfy the equations of motion or the traction boundary
conditions where they are applied is known as a \emph{kinematically admissable
  displacement field}. Similarily, a stress field $\tensor{\sigma}$ which
satisfies the equations of motion and the traction boundary conditions where
they are applied but whost resulting displacement field does not necessarily
satisfy the displacement boundary conditions where they are applied is known
as a \emph{statically admissable stress field}.

For a statically admissable stress field $\tensor{\sigma}$ conservation of
momentum gives us the equations of motion \ie
\begin{equation}
  \gint{\embedmanifold{B}}{}{\rho\vectr{a}}{v}=\gint{\embedmanifold{B}}{}{\pbrac{\divergence{}{\tensor{\sigma}}+\vectr{b}}}{v}
\end{equation}
where $\vectr{a}$ is the acceleration of the body and $\vectr{b}$ are the body
forces. If we now multiply by the equations of motion by a kinematically
admissable displacement field $\vectr{u}$ we obtain
\begin{equation}
  \begin{split}
    \gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{a}}{\vectr{u}}}{v} &=
    \gint{\embedmanifold{B}}{}{\dotprod{\pbrac{\divergence{}{\tensor{\sigma}}+\vectr{b}}}{\vectr{u}}}{v}\\
    &=\gint{\embedmanifold{B}}{}{\dotprod{\pbrac{\divergence{}{\tensor{\sigma}}}}{\vectr{u}}}{v}+
    \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\vectr{u}}}{v}
  \end{split}
  \label{eqn:equationsofwork}
\end{equation}

Now, by the vector identity
\begin{equation}
  \divergence{}{\pbrac{\dotprod{\tensortwo{\sigma}}{\vectr{u}}}}=\dotprod{\pbrac{\divergence{}{\tensortwo{\sigma}}}}{\vectr{u}}+
  \doubledotprod{\transpose{\tensortwo{\sigma}}}{\gradient{}{\vectr{u}}}
\end{equation}
we have
\begin{equation}
  \dotprod{\pbrac{\divergence{}{\tensortwo{\sigma}}}}{\vectr{u}}=\divergence{}{\pbrac{\dotprod{\tensortwo{\sigma}}{\vectr{u}}}}-
  \doubledotprod{\tensortwo{\sigma}}{\gradient{}{\vectr{u}}}
\end{equation}
as the stress tensor, $\tensortwo{\sigma}$, symmetric and so
$\transpose{\tensortwo{\sigma}}=\tensortwo{\sigma}$. \Eqnref{eqn:equationsofwork} becomes
\begin{equation}
  \begin{split}
    \gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{a}}{\vectr{u}}}{v}&=
    \gint{\embedmanifold{B}}{}{\pbrac{\divergence{}{\pbrac{\dotprod{\tensor{\sigma}}{\vectr{u}}}}-
        \doubledotprod{\tensor{\sigma}}{\gradient{}{\vectr{u}}}}}{v}+
    \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\vectr{u}}}{v} \\
    &=\gint{\embedmanifold{B}}{}{\divergence{}{\pbrac{\dotprod{\tensor{\sigma}}{\vectr{u}}}}}{v}-
    \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\gradient{}{\vectr{u}}}}{v}+
    \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\vectr{u}}}{v}
  \end{split}
\end{equation}

Applying the divergence theorem to the first integral on the right hand side
gives
\begin{equation}
  \begin{split}
    \gint{\embedmanifold{B}}{}{\divergence{}{\pbrac{\dotprod{\tensor{\sigma}}{\vectr{u}}}}}{v}
    &=\gint{\boundary{\embedmanifold{B}}}{}{\dotprod{\pbrac{\dotprod{\tensor{\sigma}}{\vectr{u}}}}{\vectr{n}}}{a}\\
    &=\gint{\boundary{\embedmanifold{B}}}{}{\dotprod{\pbrac{\dotprod{\tensor{\sigma}}{\vectr{n}}}}{\vectr{u}}}{a}
  \end{split}
\end{equation}
or, by Cauchy's law, $\vectr{t}=\dotprod{\tensor{\sigma}}{\vectr{n}}$, we have
\begin{equation}
  \gint{\embedmanifold{B}}{}{\divergence{}{\pbrac{\dotprod{\tensor{\sigma}}{\vectr{u}}}}}{v}=
  \gint{\boundary{\embedmanifold{B}}}{}{\dotprod{\vectr{t}}{\vectr{u}}}{a}
\end{equation}

\Eqnref{eqn:equationsofwork} thus becomes
\begin{equation}
  \gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{a}}{\vectr{u}}}{v}=
  \gint{\boundary{\embedmanifold{B}}}{}{\dotprod{\vectr{t}}{\vectr{u}}}{a}-
  \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\gradient{}{\vectr{u}}}}{v}+
  \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\vectr{u}}}{v}
\end{equation}
or
\begin{equation}
  \gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{a}}{\vectr{u}}}{v}+
  \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\gradient{}{\vectr{u}}}}{v}=
  \gint{\boundary{\embedmanifold{B}}}{}{\dotprod{\vectr{t}}{\vectr{u}}}{a}+
  \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\vectr{u}}}{v}
\end{equation}

Taking the boundary conditions into account we have
\begin{equation}
  \gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{a}}{\vectr{u}}}{v}+
  \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\gradient{}{\vectr{u}}}}{v}=
  \gint{\boundary{\embedmanifold{B}}_{u}}{}{\dotprod{\vectr{t}}{\bar{\vectr{u}}}}{a}+
  \gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{\bar{\vectr{t}}}{\vectr{u}}}{a}+
  \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\vectr{u}}}{v}
  \label{eqn:virtualworkdisp1}
\end{equation}

If we now consider a second kinematically admissable displacement field
$\vectr{u}^{*}$ then the above equation will also hold \ie
\begin{equation}
  \gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{a}}{\vectr{u}^{*}}}{v}+
  \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\gradient{}{\vectr{u}^{*}}}}{v}=
  \gint{\boundary{\embedmanifold{B}}_{u}}{}{\dotprod{\vectr{t}}{\bar{\vectr{u}}}}{a}+
  \gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{\bar{\vectr{t}}}{\vectr{u}^{*}}}{a}+
  \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\vectr{u}^{*}}}{v}
  \label{eqn:virtualworkdisp2}
\end{equation}

Now, subtracting \Eqnref{eqn:virtualworkdisp2} from
\Eqnref{eqn:virtualworkdisp1} gives us
\begin{equation}
  \gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{a}}{\pbrac{\vectr{u}-\vectr{u}^{*}}}}{v}+
  \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\gradient{}{\pbrac{\vectr{u}-\vectr{u}^{*}}}}}{v}=
  \gint{\boundary{\embedmanifold{B}}_{u}}{}{\dotprod{\vectr{t}}{\bar{\vectr{u}}}}{a}+
  \gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{\bar{\vectr{t}}}{\pbrac{\vectr{u}-\vectr{u}^{*}}}}{a}+
  \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\pbrac{\vectr{u}-\vectr{u}^{*}}}}{v}
  \label{eqn:virtualworkdispdiff}
\end{equation}

If we now define the \emph{virtual displacements} as
$\delta\vectr{u}=\vectr{u}-\vectr{u}^{*}$ and note that
$\delta\vectr{u}=\vectr{u}-\vectr{u}^{*}=\bar{\vectr{u}}-\bar{\vectr{u}}=\vectr{0}$
on $\boundary{\embedmanifold{B}}_{u}$ then we have
\begin{equation}
  \gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{a}}{\delta\vectr{u}}}{v}+
  \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\gradient{}{\delta\vectr{u}}}}{v}=
  \gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{\bar{\vectr{t}}}{\delta\vectr{u}}}{a}+
  \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\delta\vectr{u}}}{v}
  \label{eqn:virtualworkstatment}
\end{equation}

This is known as the \emph{Principle of Virtual Work} \ie when a deformable
body undergoes some virtual displacement, $\delta\vectr{u}$, the \emph{kinetic
  work}, $\fnof{W_{kin}}{\delta\vectr{u}}$, plus the \emph{internal work},
$\fnof{W_{int}}{\delta\vectr{u}}$, is balanced by the \emph{external work},
$\fnof{W_{ext}}{\delta\vectr{u}}$, where
\begin{equation}
  \begin{split}
    \fnof{W_{kin}}{\delta\vectr{u}}&=
    \gint{\embedmanifold{B}}{}{\rho\dotprod{\vectr{a}}{\delta\vectr{u}}}{v}\\
    \fnof{W_{int}}{\delta\vectr{u}}&=
    \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\gradient{}{\delta\vectr{u}}}}{v}\\
    \fnof{W_{ext}}{\delta\vectr{u}}&=\fnof{W_{surf}}{\delta\vectr{u}}+\fnof{W_{body}}{\delta\vectr{u}}\\
    &=\gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{\bar{\vectr{t}}}{\delta\vectr{u}}}{a}+
    \gint{\boundary{\embedmanifold{B}}_{p}}{}{\dotprod{\bar{\vectr{t}}}{\delta\vectr{u}}}{a}+
    \gint{\embedmanifold{B}}{}{\dotprod{\fnof{\vectr{b}}{\vectr{u}}}{\delta\vectr{u}}}{v}
  \end{split}
\end{equation}
where $\fnof{W_{surf}}{\vectr{u},\delta\vectr{u}}$ is the external work due to surface
forces and $\fnof{W_{body}}{\vectr{u},\delta\vectr{u}}$ is the external work due to
body forces. 

Note that the internal work is often writen in terms of \emph{virtual strain}
instead of virtual displacement. Consider
\begin{equation}
  \begin{split}
    \gradient{}{\delta\vectr{u}} &= 
    \dfrac{1}{2}\pbrac{\gradient{}{\delta\vectr{u}}+\transpose{\pbrac{\gradient{}{\delta\vectr{u}}}}}+
    \dfrac{1}{2}\pbrac{\gradient{}{\delta\vectr{u}}-\transpose{\pbrac{\gradient{}{\delta\vectr{u}}}}}\\
    &=\delta\sqbrac{\dfrac{1}{2}\pbrac{\gradient{}{\vectr{u}}+\transpose{\pbrac{\gradient{}{\vectr{u}}}}}}+
    \delta\sqbrac{\dfrac{1}{2}\pbrac{\gradient{}{\vectr{u}}-\transpose{\pbrac{\gradient{}{\vectr{u}}}}}} \\
    &=\delta\tensor{\epsilon} +\delta\tensor{\omega}
  \end{split}
\end{equation}
where $\tensor{\epsilon}$ is the \emph{small strain tensor} and
$\tensor{\omega}$ is the \emph{small rotation tensor}. The internal work is now
given by
\begin{equation}
  \begin{split}
    \fnof{W_{int}}{\vectr{u},\delta\vectr{u}}&=
    \gint{\embedmanifold{B}}{}{\doubledotprod{\fnof{\tensor{\sigma}}{\vectr{u}}}{\gradient{}{\delta\vectr{u}}}}{v}\\
    &=\gint{\embedmanifold{B}}{}{\doubledotprod{\fnof{\tensor{\sigma}}{\vectr{u}}}{
        \pbrac{\delta\tensor{\epsilon}+\delta\tensor{\omega}}}}{v} \\
    &=\gint{\embedmanifold{B}}{}{\doubledotprod{\fnof{\tensor{\sigma}}{\vectr{u}}}{\delta\tensor{\epsilon}}}{v}+
    \gint{\embedmanifold{B}}{}{\doubledotprod{\fnof{\tensor{\sigma}}{\vectr{u}}}{\delta\tensor{\omega}}}{v}
  \end{split}
\end{equation}
Therefore
\begin{equation}
  \fnof{W_{int}}{\vectr{u},\delta\tensor{\epsilon}}=
  \gint{\embedmanifold{B}}{}{\doubledotprod{\fnof{\tensor{\sigma}}{\vectr{u}}}{\delta\tensor{\epsilon}}}{v}
\end{equation}
as the stress tensor is a symmetric tensor and the small rotation tensor is a
skew-symmetric tensor and the double dot product between a symmetric and
skew-symmetric tensor is always zero.

In terms of strain the principle of virtual work can thus be stated as
\begin{equation}
  \gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{a}}{\delta\vectr{u}}}{v}+
  \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\delta\tensor{\epsilon}}}{v}=
  \gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{\bar{\vectr{t}}}{\delta\vectr{u}}}{a}+
  \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\delta\vectr{u}}}{v}
  \label{eqn:virtualworkstrainstatment}
\end{equation}

TALK ABOUT WORK CONJUGACY AND SHOW OTHER CONJUGATE FORMS

The internal work can also be expressed in the undeformed manifold in terms of
the $2^{nd}$ Piola-Kirchoff stress, $\tensor{S}$ and the Green-Lagrange strain
tensor, $\tensor{E}$, \ie
\begin{equation}
  \fnof{W_{int}}{\vectr{u},\delta\tensor{E}}=\gint{\embedmanifold{B}_{0}}{}{\doubledotprod{
      \fnof{\tensor{S}}{\vectr{u}}}{\delta\tensor{E}}}{V}
\end{equation}

Considering the external surface work it is often the case that this is due to
an external pressure. Thus the traction is given by
\begin{equation}
  \bar{\vectr{t}}=p_{ext}\hat{\vectr{n}}
\end{equation}
where $p_{ext}$ is the applied external pressure and $\hat{\vectr{n}}$ is the
unit normal vector to the surface element $\exteriorderiv{\covectr{a}}$. Now
if the surface is parameterised by the coordinates $\xi$ and $\eta$ then
\begin{equation}
  \exteriorderiv{\covectr{a}}=
  \norm{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}
  \wedgeprod{\exteriorderiv{\xi}}{\exteriorderiv{\eta}}
\end{equation}
and the unit normal is given by
\begin{equation}
  \hat{\vectr{n}}=\dfrac{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}{
    \norm{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}}
\end{equation}
where $\vectr{x}$ are the coordinates in the current configuration \ie $\vectr{x}=\vectr{X}+\vectr{u}$.

The external surface work is thus given by
\begin{equation}
  \begin{split}
    \fnof{W_{surf}}{\vectr{u},p_{ext},\delta\vectr{u}}&=
    \gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{p_{ext}\fnof{\hat{\vectr{n}}}{\vectr{u}}}{
        \delta\vectr{u}}}{\covectr{a}}\\
    &=\giint{\xi}{}{\eta}{}{\dotprod{p_{ext}\dfrac{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}{\norm{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}}}{\delta\vectr{u}}\norm{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}}{\xi}{\eta} \\
    &=\giint{\xi}{}{\eta}{}{\dotprod{p_{ext}\pbrac{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}}{\delta\vectr{u}}}{\xi}{\eta}\\
    &=\giint{\xi}{}{\eta}{}{\dotprod{p_{ext}\fnof{\vectr{n}}{\vectr{u}}}{\delta\vectr{u}}}{\xi}{\eta}
  \end{split}
\end{equation}
where $\vectr{n}$ is the normal direction (non-normalised) \ie
\begin{equation}
  \vectr{n}=\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}
\end{equation}
 
The body force is due to the effect of gravity on the body \ie
\begin{equation}
  \vectr{b}=\rho\vectr{g}
\end{equation}
where $\rho$ is the density of the current configuration and $\vectr{g}$ is
the acceleration vector due to gravity.

The external body work is thus given by
\begin{equation}
  \begin{split}
    \fnof{W_{body}}{\vectr{u},\delta\vectr{u}}
    &=\gint{\embedmanifold{B}}{}{\dotprod{\fnof{\vectr{b}}{\vectr{u}}}{\delta\vectr{u}}}{v}\\
    &=\gint{\embedmanifold{B}}{}{\dotprod{\rho\vectr{g}}{\delta\vectr{u}}}{v}\\
    &=\gint{\embedmanifold{B}_{0}}{}{\dotprod{J\dfrac{\rho_{0}}{J}\vectr{g}}{\delta\vectr{u}}}{V}\\
    &=\gint{\embedmanifold{B}_{0}}{}{\dotprod{\rho_{0}\vectr{g}}{\delta\vectr{u}}}{V}
  \end{split}
\end{equation}
where $\rho_{0}$ is the density in the reference configuration.

\begin{equation}
  c^{ijkl}=\inverse{J}F^{i}_{A}F^{j}_{B}F^{k}_{C}F^{l}_{D}C^{ABCD}
\end{equation}


If we now just consider the external traction part. For the case where the
external traction is given by a fixed external pressure we have
\begin{equation}
  \gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{\bar{\vectr{t}}}{\delta\vectr{u}}}{\covectr{a}}=\gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{p_{ext}\hat{\vectr{n}}}{\delta\vectr{u}}}{\covectr{a}}
\end{equation}
where $\hat{\vectr{n}}$ is the unit normal to the surface element
$\exteriorderiv{\covectr{a}}$. Now if the surface is parameterised by the
coordinates $\xi$ and $\eta$ then
\begin{equation}
  \exteriorderiv{\covectr{a}}=\norm{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}\wedgeprod{\exteriorderiv{\xi}}{\exteriorderiv{\eta}}
\end{equation}
and the unit normal is given by
\begin{equation}
  \hat{\vectr{n}}=\dfrac{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}{\norm{\crossprod{\delby{\vectr{x}}{\xi}}{\delby{\vectr{x}}{\eta}}}}
\end{equation}

We thus have

The directional derivative of $\fnof{\delta W_{ext}}{\vectr{u},p_{ext},\delta\vectr{u}}$ is given by
\begin{equation}
  \directionalderiv{\fnof{\delta
      W_{ext}}{\vectr{u},p_{ext},\delta\vectr{u}}}{\Delta\vectr{u},\Delta p_{ext}}=
  \giint{\xi}{}{\eta}{}{\pbrac{\dotprod{p_{ext}\vectr{n}}{\delta\vectr{u}}+\dotprod{\Delta
  p_{ext}\vectr{n}}{\delta\vectr{u}}+\dotprod{p_{ext}\Delta\vectr{n}}{\delta\vectr{u}}}}{\xi}{\eta}
\end{equation}

For problems where $p_{ext}$ is not part of the solution procedure then
$\Delta p_{ext}=0$ and thus
\begin{equation}
  \directionalderiv{\fnof{\delta
      W_{ext}}{\vectr{u},p_{ext},\delta\vectr{u}}}{\Delta\vectr{u}}=
  \giint{\xi}{}{\eta}{}{\pbrac{\dotprod{p_{ext}\vectr{n}}{\delta\vectr{u}}+
      \dotprod{p_{ext}\Delta\vectr{n}}{\delta\vectr{u}}}}{\xi}{\eta}
\end{equation}

The directional derivative of the normal vector is given by
\begin{equation}
  \directionalderiv{\vectr{n}}{\Delta\vectr{u}}=\crossprod{\delby{\Delta\vectr{u}}{\xi}}{\delby{\vectr{x}}{\eta}}-
  \crossprod{\delby{\Delta\vectr{u}}{\eta}}{\delby{\vectr{x}}{\xi}}
\end{equation}
and thus we have
\begin{equation}
  \directionalderiv{\fnof{\delta
      W_{ext}}{\vectr{u},p_{ext},\delta\vectr{u}}}{\Delta\vectr{u}}=
  \giint{\xi}{}{\eta}{}{\pbrac{\dotprod{p_{ext}\vectr{n}}{\delta\vectr{u}}+
      \dotprod{p_{ext}\pbrac{\crossprod{\delby{\Delta\vectr{u}}{\xi}}{\delby{\vectr{x}}{\eta}}-
  \crossprod{\delby{\Delta\vectr{u}}{\eta}}{\delby{\vectr{x}}{\xi}}}}{\delta\vectr{u}}}}{\xi}{\eta}
\end{equation}

The transformation rule for a triple product is
\begin{equation}
  \dotprod{\vectr{a}}{\pbrac{\crossprod{\vectr{b}}{\vectr{c}}}}=
  \dotprod{\vectr{b}}{\pbrac{\crossprod{\vectr{c}}{\vectr{a}}}}=
  \dotprod{\vectr{c}}{\pbrac{\crossprod{\vectr{a}}{\vectr{b}}}}
\end{equation}
and so we have
\begin{equation}
  \begin{split}
    \directionalderiv{\fnof{\delta
        W_{ext}}{\vectr{u},p_{ext},\delta\vectr{u}}}{\Delta\vectr{u}}&=\giint{\xi}{}{\eta}{}{\pbrac{\dotprod{p_{ext}\vectr{n}}{\delta\vectr{u}}+
        \dotprod{p_{ext}\pbrac{\crossprod{\delby{\Delta\vectr{u}}{\xi}}{\delby{\vectr{x}}{\eta}}-
            \crossprod{\delby{\Delta\vectr{u}}{\eta}}{\delby{\vectr{x}}{\xi}}}}{\delta\vectr{u}}}}{\xi}{\eta}\\
    &=p_{ext}\giint{\xi}{}{\eta}{}{\pbrac{\dotprod{\vectr{n}}{\delta\vectr{u}}+
        \dotprod{\pbrac{\crossprod{\delby{\vectr{x}}{\eta}}{\delta\vectr{u}}}}{\delby{\Delta\vectr{u}}{\xi}}-
        \dotprod{\pbrac{\crossprod{\delby{\vectr{x}}{\xi}}{\delta\vectr{u}}}}{\delby{\Delta\vectr{u}}{\eta}}}}{\xi}{\eta}
  \end{split}
  \label{eqn:nonsympressuredirectderiv}
\end{equation}

Now \eqnref{eqn:nonsympressuredirectderiv} is, in general, non-symmetric in terms of
$\Delta \vectr{u}$ and $\delta\vectr{u}$. This will equate to a
non-conservative force. 

Consider now the directional derivative of the incompressibility constraint \ie
\begin{equation}
  \begin{split}
    \directionalderiv{\gint{\vectr{0}}{\vectr{1}}{\pbrac{\fnof{J}{\delta\vectr{u}}-1}
        \gbfn{m}{\pbrac{N+1}\alpha}{\vectr{\xi}}\gsf{m}{\alpha}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}}{\Delta\vectr{u}}
    \\ &=\gsf{m}{\alpha}\gint{\vectr{0}}{\vectr{1}}{\pbrac{J-1}\gbfn{m}{\pbrac{N+1}\alpha}{\vectr{\xi}}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
  \end{split}
\end{equation}

\subsection{Finite Element Formulation}

\subsubsection{Residual}

The residual statement is given by
\begin{equation}
  R=\delta\fnof{\Pi}{\vectr{u},\delta\vectr{u}}=0
\end{equation}

Firstly, consider the displacement, $\vectr{u}$, between the
reference/material coordinates, $\vectr{x}$, and the current/spatial
coordinates, $\vectr{z}$. The displacement is defined by
\begin{equation}
  \vectr{u}=\vectr{z}-\vectr{x}
\end{equation}
and thus
\begin{equation}
  \begin{split}
    \delta\vectr{u} &=\delta\pbrac{\vectr{z} -\vectr{X}} \\
    &=\delta\vectr{z}-\delta\vectr{X} \\
    &=\delta\vectr{z}
  \end{split}
\end{equation}
as there is no variation in the original reference configuration $\vectr{X}$. 

The variational statement  is 
\begin{equation}
  \gint{\embedmanifold{B}}{}{\doubledotprod{\pbrac{\tensor{\sigma}+
        \tensor{\sigma}_{p}}}{\gradient{}{\delta\vectr{u}}}}{v}=
  \gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{\bar{\vectr{t}}}{\delta\vectr{u}}}{a}+
  \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\delta\vectr{u}}}{v}
\end{equation}
or
\begin{equation}
  \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}}{\gradient{}{\delta\vectr{u}}}}{v}+
  \gint{\embedmanifold{B}}{}{\doubledotprod{\tensor{\sigma}_{p}}{\gradient{}{\delta\vectr{u}}}}{v}=
  \gint{\boundary{\embedmanifold{B}}_{t}}{}{\dotprod{\bar{\vectr{t}}}{\delta\vectr{u}}}{a}+
  \gint{\embedmanifold{B}}{}{\dotprod{\vectr{b}}{\delta\vectr{u}}}{v}
\end{equation}

In component form, we have
\begin{equation}
  \gint{\embedmanifold{B}}{}{\sigma^{ij}\covarderiv{\delta u_{j}}{i}}{v}+
  \gint{\embedmanifold{B}}{}{\sigma^{ij}_{p}\covarderiv{\delta u_{j}}{i}}{v}=
  \gint{\embedmanifold{B}}{}{b^{j}\delta u_{j}}{v}+
  \gint{\boundary{\embedmanifold{B}}}{}{t^{j}\delta u_{j}}{a}
\end{equation}

The first integral on the left hand side of the virtual work statement is
\begin{equation}
  \begin{split}
    \gint{\embedmanifold{B}}{}{\sigma^{ij}\covarderiv{\delta u_{j}}{i}}{v}
    &= \gint{\embedmanifold{B}}{}{\sigma^{ij}\pbrac{\partialderiv{\delta
          u_{j}}{i}-\christoffel{k}{j}{i}\delta u_{k}}}{v} \\
    &= \gint{\embedmanifold{B}}{}{\sigma^{ij}\pbrac{\delby{\delta
          u_{j}}{x^{i}}-\christoffel{k}{j}{i}\delta u_{k}}}{v}
  \end{split}
\end{equation}
and thus the second integral on the left hand side is
\begin{equation}
  \gint{\embedmanifold{B}}{}{\sigma^{ij}_{p}\covarderiv{\delta u_{j}}{i}}{v}=
  \gint{\embedmanifold{B}}{}{\sigma^{ij}_{p}\pbrac{\delby{\delta
        u_{j}}{x^{i}}-\christoffel{k}{j}{i}\delta u_{k}}}{v}
\end{equation}

If we now substitute $\delta\vectr{u}=\delta\vectr{z}$ and convert the left
hand side of the virtual work statement from an integral with respect to
spatial coordinates to an integral with respect to $\vectr{\xi}$ coordinates we obtain

\begin{equation}
  \begin{split}
    \gint{\embedmanifold{B}}{}{\sigma^{ij}\pbrac{\delby{\delta
          u_{j}}{x^{i}}-\christoffel{k}{j}{i}\delta u_{k}}}{v}
    &= \gint{\embedmanifold{B}}{}{\sigma^{ij}\pbrac{\delby{\delta
          z_{j}}{x^{i}}-\christoffel{k}{j}{i}\delta z_{k}}}{v} \\
    &= \gint{\vectr{0}}{\vectr{1}}{\fnof{\sigma^{ij}}{\vectr{\xi}}\pbrac{\delby{\xi_{l}}{x^{i}}\delby{\delta
          \fnof{z_{j}}{\vectr{\xi}}}{\xi^{l}}-\christoffel{k}{j}{i}\delta\fnof{z_{k}}{\vect{\xi}}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
  \end{split}
\end{equation}

Note that in rectangular cartesian coordinates $\christoffel{k}{j}{i}=0$ 
$\forall i,j,k$. In addition it is not necessary to transform either the
Cauchy stress tensor or gradient of the virtual displacements so that the
components are with respect to $\vectr{\xi}$ coordinates. What is important is that
the stress and displacement are with respect to the same coordinate
system. Because the gradient of $\delta \vectr{z}$ is with respect to $\vectr{x}$ coordinates
then $\tensor{\sigma}$ needs to be with respect to $\vectr{x}$ coordinates. As there
is no coordinate transformations the Christoffel symbols are all zero and can
be dropped.

The second integral on the left hand side is thus
\begin{equation}
  \gint{\embedmanifold{B}}{}{\sigma^{ij}_{p}\pbrac{\delby{\delta
        u_{j}}{x^{i}}-\christoffel{k}{j}{i}\delta u_{k}}}{v}=
  \gint{\vectr{0}}{\vectr{1}}{\fnof{\sigma^{ij}_{p}}{\vectr{\xi}}
    \delby{\xi_{l}}{x^{i}}\delby{\delta\fnof{z_{j}}{\vectr{\xi}}}{\xi^{l}}
    \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
\end{equation}

The right hand side of the virtual work statement is
\begin{equation}
  \begin{split}
    \gint{\embedmanifold{B}}{}{b^{j}\delta u_{j}}{v}+
    \gint{\boundary{\embedmanifold{B}_{t}}}{}{\bar{t}^{j}\delta u_{j}}{a}
    &= \gint{\embedmanifold{B}}{}{b^{j}\delta z_{j}}{v}+
    \gint{\boundary{\embedmanifold{B}_{t}}}{}{t^{j}\delta z_{j}}{a} +
    \gint{\boundary{\embedmanifold{B}_{P}}}{}{Pn^{j}\delta z_{j}}{a} \\
    &= \gint{\vectr{0}}{\vectr{1}}{\fnof{b^{j}}{\vectr{\xi}}\delta
      \fnof{z_{j}}{\vectr{\xi}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}\\
    &\quad+\gint{\vectr{0}}{\vectr{1}}{\fnof{t^{j}}{\vectr{\xi}}\delta
      \fnof{z_{j}}{\vectr{\xi}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}\\ 
    &\quad+\gint{\vectr{0}}{\vectr{1}}{\fnof{P}{\vectr{\xi}}\fnof{n^{j}}{\vectr{\xi}}\delta
      \fnof{z_{j}}{\vectr{\xi}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}    
   \end{split}
\end{equation}
where $P$ is the applied surface pressure.

If we now use basis functions to interpolate the virtual displacements \ie
\begin{equation}
  \delta \fnof{z_{j}}{\vectr{\xi}} = \idxgbfn{j}{m}{\alpha}{\vectr{\xi}}\delta z_{j,\alpha}^{m}\gsf{m}{\alpha}
\end{equation}
which, assuming rectangular cartesian coordinates, gives for the first left hand side integral
\begin{equation}
  \begin{split}
    \gint{\vectr{0}}{\vectr{1}}{\fnof{\sigma^{ij}}{\vectr{\xi}}\delby{\xi_{l}}{x^{i}}\delby{\delta
          \fnof{z_{j}}{\vectr{\xi}}}{\xi^{l}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
    &= \gint{\vectr{0}}{\vectr{1}}{\fnof{\sigma^{ij}}{\vectr{\xi}}\delby{\xi_{l}}{x^{i}}\delby{
          \pbrac{\idxgbfn{j}{m}{\alpha}{\vectr{\xi}}\delta z_{j,\alpha}^{m}\gsf{m}{\alpha}}}{\xi^{l}}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}} \\
    &= \gint{\vectr{0}}{\vectr{1}}{\fnof{\sigma^{ij}}{\vectr{\xi}}\delby{\xi_{l}}{x^{i}}\delby{
          \idxgbfn{j}{m}{\alpha}{\vectr{\xi}}}{\xi^{l}}\delta z_{j,\alpha}^{m}\gsf{m}{\alpha}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}} \\
    &= \delta z_{j,\alpha}^{m}\gsf{m}{\alpha}
    \gint{\vectr{0}}{\vectr{1}}{\fnof{\sigma^{ij}}{\vectr{\xi}}\delby{\xi_{l}}{x^{i}}\delby{
          \gbfn{m}{j\alpha}{\vectr{\xi}}}{\xi^{l}}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}} 
  \end{split}
\end{equation}
and for the second left hand side integral
\begin{equation}
  \gint{\vectr{0}}{\vectr{1}}{\fnof{\sigma^{ij}_{p}}{\vectr{\xi}}\delby{\xi_{l}}{x^{i}}\delby{\delta
      \fnof{z_{j}}{\vectr{\xi}}}{\xi^{l}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}=
  \delta z_{j,\alpha}^{m}\gsf{m}{\alpha}
  \gint{\vectr{0}}{\vectr{1}}{\fnof{\sigma^{ij}_{p}}{\vectr{\xi}}\delby{\xi_{l}}{x^{i}}\delby{
      \gbfn{m}{j\alpha}{\vectr{\xi}}}{\xi^{l}}
    \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}} 
\end{equation}
and for the first integral on the right hand side integral we have
\begin{equation}
  \begin{split}
    \gint{\vectr{0}}{\vectr{1}}{\fnof{b^{j}}{\vectr{\xi}}\delta
      \fnof{z_{j}}{\vectr{\xi}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
    &= \gint{\vectr{0}}{\vectr{1}}{\fnof{b^{j}}{\vectr{\xi}}
      \idxgbfn{j}{m}{\alpha}{\vectr{\xi}}\delta
      z_{j,\alpha}^{m}\gsf{m}{\alpha}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}} \\
    &= \delta
    z_{j,\alpha}^{m}\gsf{m}{\alpha}\gint{\vectr{0}}{\vectr{1}}{\fnof{b^{j}}{\vectr{\xi}}\gbfn{m}{j\alpha}{\vectr{\xi}}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
  \end{split}
\end{equation}
and for the second integral on the right hand side we have
\begin{equation}
  \begin{split}
    \gint{\vectr{0}}{\vectr{1}}{\fnof{t^{j}}{\vectr{\xi}}\delta
      \fnof{z_{j}}{\vectr{\xi}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
    &= \gint{\vectr{0}}{\vectr{1}}{\fnof{t^{j}}{\vectr{\xi}}
      \idxgbfn{j}{m}{\alpha}{\vectr{\xi}}\delta
      z_{j,\alpha}^{m}\gsf{m}{\alpha}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}} \\
    &= \delta
    z_{j,\alpha}^{m}\gsf{m}{\alpha}\gint{\vectr{0}}{\vectr{1}}{\fnof{t^{j}}{\vectr{\xi}}\gbfn{m}{j\alpha}{\vectr{\xi}}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
  \end{split}
\end{equation}
and for the third integral on the right hand side we have
\begin{equation}
  \begin{split}
    \gint{\vectr{0}}{\vectr{1}}{\fnof{P}{\vectr{\xi}}\fnof{n^{j}}{\vectr{\xi}}\delta
      \fnof{z_{j}}{\vectr{\xi}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
    &= \gint{\vectr{0}}{\vectr{1}}{\fnof{P}{\vectr{\xi}}\fnof{n^{j}}{\vectr{\xi}}
      \idxgbfn{j}{m}{\alpha}{\vectr{\xi}}\delta
      z_{j,\alpha}^{m}\gsf{m}{\alpha}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
    \\
    &= \delta z_{j,\alpha}^{m}\gsf{m}{\alpha}\gint{\vectr{0}}{\vectr{1}}{\fnof{P}{\vectr{\xi}}\fnof{n^{j}}{\vectr{\xi}}
      \gbfn{m}{j\alpha}{\vectr{\xi}}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
  \end{split}
\end{equation}

This can be formulated as
\begin{equation}
  r_{m}^{j\alpha}\delta z_{j,\alpha}^{m}=0
\end{equation}
where the residual vector is thus given by
\begin{multline}
  r_{m}^{j\alpha}=\gsf{m}{\alpha}\left(
    \gint{\vectr{0}}{\vectr{1}}{\pbrac{\fnof{\sigma^{ij}}{\vectr{\xi}}\delby{\xi_{l}}{x^{i}}\delby{
          \gbfn{m}{j\alpha}{\vectr{\xi}}}{\xi^{l}}+\rho\pbrac{
        \fnof{a^{j}}{\vectr{\xi}}-\fnof{b^{j}}{\vectr{\xi}}}\gbfn{m}{j\alpha}{\vectr{\xi}}}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}\right. \\
    \left.-\gint{\vectr{0}}{\vectr{1}}{\fnof{P}{\vectr{\xi}}\fnof{n^{j}}{\vectr{\xi}}
      \gbfn{m}{j\alpha}{\vectr{\xi}}
      \fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}\right)
\end{multline}

Now, as the virtual displacements are arbitrary we have the residual statement
\begin{equation}
  r_{m}^{j\alpha}=0
\end{equation}

In order to handle incompressible materials we need an additional constraint
which penalises change in volume. The change in volume is given by
\begin{equation}
  \Delta V = \dfrac{\sqrt{\det \tensor{g}}}{J_{g}\sqrt{\det \tensor{G}}}
\end{equation}
and the residual equation is
\begin{equation}
  \begin{split}
    r_{m}^{\pbrac{N+1}\alpha}&=\gint{\vectr{0}}{\vectr{1}}{\pbrac{\fnof{\Delta V}{\vectr{\xi}} -
        1}\gbfn{m}{\pbrac{N+1}\alpha}{\vectr{\xi}}\gsf{m}{\alpha}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
    \\
    &=\gsf{m}{\alpha}\gint{\vectr{0}}{\vectr{1}}{\pbrac{\dfrac{\sqrt{\det
            \fnof{\tensor{g}}{\vectr{\xi}}}}{\fnof{J_{g}}{\vectr{\xi}}\sqrt{\det
            \fnof{\tensor{G}}{\vectr{\xi}}}} -
        1}\gbfn{m}{\pbrac{N+1}\alpha}{\vectr{\xi}}\fnof{J_{\embedmanifold{B}}}{\vectr{\xi}}}{\vectr{\xi}}
  \end{split}
\end{equation}
where $N$ is the number of dimensions.

\subsubsection{Jacobian}

In order to solve the nonlinear system of equations a Newton scheme can be
used. To calculate the Jacobian of the system we need to calculate the
variation of the virtual work statement. The Jacobian is given by the
derivative of the residual equation in the direction of a change in
$\vectr{u}$, $\Delta{\vectr{u}}$ \ie the Lie derivative of the residual vector
in the direction $\Delta{\vectr{u}}$.

This requires a linerization. A linearisation of a function
$\fnof{f}{\vectr{x}}$ in the direction of $\Delta\vectr{x}$ is
\begin{equation}
  \linearisation{f}{\vectr{x}}{\Delta\vectr{x}}=\dby{}{\epsilon}\evalat{\fnof{f}{\vectr{x}+\epsilon\Delta\vectr{x}}}{\epsilon=0}=\fnof{f}{\vectr{x}}+\directionalderiv{\fnof{f}{\vectr{x}}}{\Delta\vectr{x}}
\end{equation}

The linearization of the residual equation is given by 
\begin{equation}
  \begin{split}
    \directionalderiv{\delta\fnof{\Pi}{\vectr{u},\delta\vectr{u}}}{\Delta\vectr{u}}&=
    \directionalderiv{\delta\fnof{W_{int}}{\vectr{u},\delta\vectr{u}}-
      \delta\fnof{W_{ext}}{\vectr{u},\delta\vectr{u}}}{\Delta\vectr{u}}\\
    &=\directionalderiv{\delta\fnof{W_{int}}{\vectr{u},\delta\vectr{u}}}{\Delta\vectr{u}}-
    \directionalderiv{\delta\fnof{W_{ext}}{\vectr{u},\delta\vectr{u}}}{\Delta\vectr{u}}
  \end{split}
\end{equation}

For the directional derivative of the internal work variation it is useful to consider
the internal work in terms of second Piola-Kirchoff stress and the
Green-Lagrange strain \ie
\begin{equation}
  \begin{split}
    \directionalderiv{\delta\fnof{W_{int}}{\vectr{u},\delta\vectr{u}}}{\Delta\vectr{u}}&=
    \directionalderiv{\gint{\embedmanifold{B}_{0}}{}{\doubledotprod{\fnof{\tensor{S}}{
            \fnof{\tensor{E}}{\vectr{u}}}}{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}}{V}}{\Delta\vectr{u}}\\
    &=\gint{\embedmanifold{B}_{0}}{}{\pbrac{\doubledotprod{\fnof{\tensor{S}}{
          \fnof{\tensor{E}}{\vectr{u}}}}{\directionalderiv{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}{\Delta\vectr{u}}}+
      \doubledotprod{\directionalderiv{\fnof{\tensor{S}}{
            \fnof{\tensor{E}}{\vectr{u}}}}{\Delta\vectr{u}}}{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}}}{V}
  \end{split}
\end{equation}
(SPLIT T INTO DEVIATORIC PART PLUS HYDROSTATIC STRESS)

Now, $\delta\fnof{\tensortwo{E}}{\delta\vectr{u}}$ can be found by pulling
back $\delta\fnof{\tensortwo{\epsilon}}{\delta\vectr{u}}$ \ie
\begin{equation}
  \begin{split}
    \delta\fnof{\tensortwo{E}}{\delta\vectr{u}}&=
    \transpose{\tensortwo{F}}\delta\fnof{\tensortwo{\epsilon}}{\delta\vectr{u}}\tensortwo{F}\\
    &=\transpose{\tensortwo{F}}\frac{1}{2}\pbrac{\transpose{\pbrac{\gradient{\vectr{x}}{\delta\vectr{u}}}}
      +\gradient{\vectr{x}}{\delta\vectr{u}}}\tensortwo{F}\\
    &=\frac{1}{2}\pbrac{\transpose{\tensortwo{F}}\transpose{\pbrac{\gradient{\vectr{x}}{\delta\vectr{u}}}}\tensortwo{F}+
      \transpose{\tensortwo{F}}\gradient{\vectr{x}}{\delta\vectr{u}}\tensortwo{F}}\\
    &=\frac{1}{2}\pbrac{\transpose{\pbrac{\gradient{\vectr{X}}{\delta\vectr{u}}}}\tensortwo{F}+
      \transpose{\tensortwo{F}}\gradient{\vectr{X}}{\delta\vectr{u}}} \\
    &= \sympart\pbrac{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\delta\vectr{u}}}
  \end{split}
\end{equation}

Now, recall that
\begin{equation}
  \tensortwo{F}=\tensortwo{I}+\delby{\vectr{u}}{\vectr{X}}=\tensortwo{I}+\gradient{\vectr{X}}{\vectr{u}}
\end{equation}
and so
\begin{equation}
  \directionalderiv{\tensortwo{F}}{\Delta\vectr{u}}=\gradient{\vectr{X}}{\Delta\vectr{u}}
\end{equation}

We thus have
\begin{equation}
  \begin{split}
    \directionalderiv{\delta\fnof{\tensortwo{E}}{\delta\vectr{u}}}{\Delta\vectr{u}}&=
    \directionalderiv{\sympart\pbrac{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\delta\vectr{u}}}}{\Delta\vectr{u}}\\
    &=\sympart\pbrac{\transpose{\tensortwo{F}}\directionalderiv{\gradient{\vectr{X}}{\delta\vectr{u}}}{\Delta\vectr{u}}+
      \transpose{\pbrac{\directionalderiv{\tensortwo{F}}{\Delta\vectr{u}}}}\gradient{\vectr{X}}{\delta\vectr{u}}}\\
    &=\sympart\pbrac{0+\transpose{\pbrac{\gradient{\vectr{X}}{\Delta\vectr{u}}}}\gradient{\vectr{X}}{\delta\vectr{u}}}\\
    &=\sympart\pbrac{\transpose{\pbrac{\gradient{\vectr{X}}{\Delta\vectr{u}}}}\gradient{\vectr{X}}{\delta\vectr{u}}}
  \end{split}
\end{equation}
as $\delta\vectr{u}$ is independent of $\vectr{u}$ and is this unaffected by
the directional derivative (CHECK).

We also have
\begin{equation}
  \directionalderiv{\fnof{\tensortwo{E}}{\delta\vectr{u}}}{\Delta\vectr{u}}=
  \sympart\pbrac{\transpose{\pbrac{\gradient{\vectr{X}}{\Delta\vectr{u}}}}\tensortwo{F}}
\end{equation}
(DERIVE).

Now
\begin{equation}
  \directionalderiv{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\Delta\vectr{u}}=
  \doubledotprod{\delby{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\fnof{\tensor{E}}{\vectr{u}}}}{
    \directionalderiv{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}{\Delta\vectr{u}}}
\end{equation}

The derivative of the stress tensor with respect to the strain tensor is the
fourth order \emph{elasticity tensor} (sometimes called the \emph{stiffness
  tensor}) \ie
\begin{equation}
  \tensorfour{C}=\delby{\fnof{\tensortwo{S}}{\tensortwo{E}}}{\tensortwo{E}}
\end{equation}
or in component form
\begin{equation}
  C^{ABCD}=\delby{S^{AB}}{E_{CD}}
\end{equation}

Thus we have
\begin{equation}
  \begin{split}
    \doubledotprod{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\directionalderiv{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}{\Delta\vectr{u}}}&=
    \doubledotprod{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\sympart\pbrac{\transpose{\pbrac{\gradient{\vectr{X}}{\Delta\vectr{u}}}}\gradient{\vectr{X}}{\delta\vectr{u}}}}\\
    &=\doubledotprod{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\transpose{\pbrac{\gradient{\vectr{X}}{\Delta\vectr{u}}}}\gradient{\vectr{X}}{\delta\vectr{u}}}\\
    &=\doubledotprod{\gradient{\vectr{X}}{\delta\vectr{u}}}{\gradient{\vectr{X}}{\Delta\vectr{u}}\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}
  \end{split}
\end{equation}
as
$\doubledotprod{\tensor{A}}{\transpose{\tensor{B}}\tensor{C}}=\doubledotprod{\tensor{C}}{\tensor{B}\tensor{A}}$, and
\begin{equation}
  \begin{split}
    \doubledotprod{\directionalderiv{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\Delta\vectr{u}}}{\delta\fnof{\tensortwo{E}}{\delta\vectr{u}}}
    &=\doubledotprod{\doubledotprod{\delby{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\fnof{\tensor{E}}{\vectr{u}}}}{\directionalderiv{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}{\Delta\vectr{u}}}}{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}\\
    &=\doubledotprod{\doubledotprod{\tensorfour{C}}{\sympart\pbrac{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\Delta\vectr{u}}}}}{\sympart\pbrac{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\delta\vectr{u}}}}\\
    &=\doubledotprod{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\delta\vectr{u}}}{\doubledotprod{\tensorfour{C}}{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\Delta\vectr{u}}}}
  \end{split}
\end{equation}
as
$\doubledotprod{\tensor{A}}{\tensor{B}}=\doubledotprod{\tensor{B}}{\tensor{A}}$.

Putting this together gives
\begin{equation}
  \directionalderiv{\delta\fnof{W_{int}}{\vectr{u},\delta\vectr{u}}}{\Delta\vectr{u}}=\gint{\embedmanifold{B}_{0}}{}{\pbrac{\doubledotprod{\gradient{\vectr{X}}{\delta\vectr{u}}}{\gradient{\vectr{X}}{\Delta\vectr{u}}\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}+\doubledotprod{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\delta\vectr{u}}}{\doubledotprod{\tensorfour{C}}{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\Delta\vectr{u}}}}}}{V}
\end{equation}
or, in component form,
\begin{equation}
  \begin{split}
    \directionalderiv{\delta\fnof{W_{int}}{u_{i},\delta
        u_{i}}}{\Delta u_{j}}&=\gint{\embedmanifold{B}_{0}}{}{\pbrac{\delby{\delta
          u_{i}}{X^{B}}\delby{\Delta u_{j}}{X^{D}}\contrakronecker{i}{j}T^{BD}+F^{i}_{A}\delby{\delta
          u_{i}}{X^{B}}C^{ABCD}F^{j}_{C}\delby{\Delta u_{j}}{X^{D}}}}{V}\\
    &=\gint{\embedmanifold{B}_{0}}{}{\pbrac{\delby{\delta
          u_{i}}{X^{B}}\sqbrac{\contrakronecker{i}{j}T^{BD}+F^{i}_{A}F^{j}_{C}C^{ABCD}}\delby{\Delta u_{j}}{X^{D}}}}{V}
  \end{split}
\end{equation}

Now, consider the directional derivative of the internal work variation in the current
configuration \ie with respect to cauchy stress and ??? strain
\begin{equation}
  \begin{split}
    \directionalderiv{\delta\fnof{W_{int}}{\vectr{u},\delta\vectr{u}}}{\Delta\vectr{u}}&=
    \directionalderiv{\gint{\embedmanifold{B}_{0}}{}{\doubledotprod{\fnof{\tensor{\sigma}}{
            \fnof{\tensor{e}}{\vectr{u}}}}{\delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}}}{V}}{\Delta\vectr{u}}\\
    &=\gint{\embedmanifold{B}_{0}}{}{\pbrac{\doubledotprod{\fnof{\tensor{\sigma}}{
          \fnof{\tensor{e}}{\vectr{u}}}}{\directionalderiv{\delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}}{\Delta\vectr{u}}}+
      \doubledotprod{\directionalderiv{\fnof{\tensor{\sigma}}{
            \fnof{\tensor{e}}{\vectr{u}}}}{\Delta\vectr{u}}}{\delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}}}}{V}
  \end{split}
\end{equation}

We can now use a push forward operation to find the directional derivative of the
Cauchy stress in terms of the results from the directional derivative of the second
Piola-Kirchoff stress \ie
\begin{equation}
  \begin{split}
    \fnof{\tensor{\sigma}}{\fnof{\tensor{e}}{\vectr{u}}}&=
    \inverse{J}\pushforward{\chi}{\pbrac{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}}\\
    \directionalderiv{\fnof{\tensor{\sigma}}{\fnof{\tensor{e}}{\vectr{u}}}}{\Delta\vectr{u}}&=
    \inverse{J}\pushforward{\chi}{\pbrac{\directionalderiv{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\Delta\vectr{u}}}}\\
    \directionalderiv{\delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}}{\Delta\vectr{u}}&=
    \pushforward{\chi}{\pbrac{\directionalderiv{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}{\Delta\vectr{u}}}}\\
    \delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}&=\pushforward{\chi}{\pbrac{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}}
  \end{split}
\end{equation}

Now,
\begin{equation}
  \begin{split}
    \directionalderiv{\fnof{\tensor{\sigma}}{\fnof{\tensor{e}}{\vectr{u}}}}{\Delta\vectr{u}}&=
    \inverse{J}\pushforward{\chi}{\pbrac{\directionalderiv{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\Delta\vectr{u}}}}\\
    &=\inverse{J}\pushforward{\chi}{\pbrac{\doubledotprod{\tensorfour{C}}{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\Delta\vectr{u}}}}}\\
    &=\inverse{J}\tensor{F}\pbrac{\doubledotprod{\tensorfour{C}}{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\Delta\vectr{u}}}}\transpose{\tensor{F}}
  \end{split}
\end{equation}

The push forward of the fourth order elasticity tensor is
\begin{equation}
  \tensorfour{c}=\inverse{J}\pushforward{\chi}{\pbrac{\tensorfour{C}}}
\end{equation}

In component form this is
\begin{equation}
  c^{ijkl}=\inverse{J}F^{i}_{A}F^{j}_{B}F^{k}_{C}F^{l}_{D}C^{ABCD}
\end{equation}


Now, consider the directional derivative of the internal work variation in the current
configuration \ie with respect to cauchy stress and ??? strain
\begin{equation}
  \begin{split}
    \directionalderiv{\delta\fnof{W_{int}}{\vectr{u},\delta\vectr{u}}}{\Delta\vectr{u}}&=
    \directionalderiv{\gint{\embedmanifold{B}_{0}}{}{\doubledotprod{\fnof{\tensor{\sigma}}{
            \fnof{\tensor{e}}{\vectr{u}}}}{\delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}}}{V}}{\Delta\vectr{u}}\\
    &=\gint{\embedmanifold{B}_{0}}{}{\pbrac{\doubledotprod{\fnof{\tensor{\sigma}}{
          \fnof{\tensor{e}}{\vectr{u}}}}{\directionalderiv{\delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}}{\Delta\vectr{u}}}+
      \doubledotprod{\directionalderiv{\fnof{\tensor{\sigma}}{
            \fnof{\tensor{e}}{\vectr{u}}}}{\Delta\vectr{u}}}{\delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}}}}{V}
  \end{split}
\end{equation}

We can now use a push forward operation to find the directional derivative of the
Cauchy stress in terms of the results from the directional derivative of the second
Piola-Kirchoff stress \ie
\begin{equation}
  \begin{split}
    \fnof{\tensor{\sigma}}{\fnof{\tensor{e}}{\vectr{u}}}&=
    \inverse{J}\pushforward{\chi}{\pbrac{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}}\\
    \directionalderiv{\fnof{\tensor{\sigma}}{\fnof{\tensor{e}}{\vectr{u}}}}{\Delta\vectr{u}}&=
    \inverse{J}\pushforward{\chi}{\pbrac{\directionalderiv{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\Delta\vectr{u}}}}\\
    \directionalderiv{\delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}}{\Delta\vectr{u}}&=
    \pushforward{\chi}{\pbrac{\directionalderiv{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}{\Delta\vectr{u}}}}\\
    \delta\fnof{\tensor{\epsilon}}{\delta\vectr{u}}&=\pushforward{\chi}{\pbrac{\delta\fnof{\tensor{E}}{\delta\vectr{u}}}}
  \end{split}
\end{equation}

Now,
\begin{equation}
  \begin{split}
    \directionalderiv{\fnof{\tensor{\sigma}}{\fnof{\tensor{e}}{\vectr{u}}}}{\Delta\vectr{u}}&=
    \inverse{J}\pushforward{\chi}{\pbrac{\directionalderiv{\fnof{\tensor{S}}{\fnof{\tensor{E}}{\vectr{u}}}}{\Delta\vectr{u}}}}\\
    &=\inverse{J}\pushforward{\chi}{\pbrac{\doubledotprod{\tensorfour{C}}{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\Delta\vectr{u}}}}}\\
    &=\inverse{J}\tensor{F}\pbrac{\doubledotprod{\tensorfour{C}}{\transpose{\tensortwo{F}}\gradient{\vectr{X}}{\Delta\vectr{u}}}}\transpose{\tensor{F}}
  \end{split}
\end{equation}

The push forward of the fourth order elasticity tensor is
\begin{equation}
  \tensorfour{c}=\inverse{J}\pushforward{\chi}{\pbrac{\tensorfour{C}}}
\end{equation}

In component form this is
\begin{equation}
  c^{ijkl}=\inverse{J}F^{i}_{A}F^{j}_{B}F^{k}_{C}F^{l}_{D}C^{ABCD}
\end{equation}

Putting this together gives
\begin{equation}
  \directionalderiv{\delta\fnof{W_{int}}{\vectr{u},\delta\vectr{u}}}{\Delta\vectr{u}}=
  \gint{\embedmanifold{B}}{}{\pbrac{\doubledotprod{\gradient{\vectr{x}}{\delta\vectr{u}}}{\gradient{\vectr{x}}{\Delta\vectr{u}}\fnof{\tensor{\sigma}}{\fnof{\tensor{e}}{\vectr{u}}}}+
      \doubledotprod{\gradient{\vectr{x}}{\delta\vectr{u}}}{\doubledotprod{\tensorfour{c}}{\gradient{\vectr{x}}{\Delta\vectr{u}}}}}}{v}
\end{equation}
or, in component form,
\begin{equation}
  \begin{split}
    \directionalderiv{\delta\fnof{W_{int}}{u_{i},\delta u_{i}}}{\Delta u_{j}}&=
    \gint{\embedmanifold{B}}{}{\pbrac{\delby{\delta u_{i}}{x^{k}}\delby{\Delta
          u_{j}}{x^{l}}\contrakronecker{i}{j}\sigma^{kl}+
        \delby{\delta u_{i}}{x^{k}}c^{ikjl}\delby{\Delta u_{j}}{x^{l}}}}{v}\\
    &=\gint{\embedmanifold{B}}{}{\pbrac{\delby{\delta
          u_{i}}{x^{k}}\sqbrac{\contrakronecker{i}{j}\sigma^{kl}+c^{ikjl}}\delby{\Delta u_{j}}{x^{l}}}}{v}
  \end{split}
\end{equation}

\subsection{Constituative Laws}

The constituative law can then be used to derive the second Piola Kirchhoff
stress tensor in fibre coordinates, $\fnof{\tensor{S}}{\vectr{\nu}}$, from
either the right Cauchy-Green deformation tensor or the Green-Lagrange strain
tensor \ie
\begin{equation}
  \fnof{\tensor{S}}{\vectr{\nu}}=2\delby{\fnof{W}{\fnof{\tensor{C}}{\vectr{\nu}}}}{\fnof{\tensor{C}}{\vectr{\nu}}}
\end{equation}
or
\begin{equation}
  \fnof{\tensor{S}}{\vectr{\nu}}=\delby{\fnof{W}{\fnof{\tensor{E}}{\vectr{\nu}}}}{\fnof{\tensor{E}}{\vectr{\nu}}}
\end{equation}
where $\fnof{W}{\fnof{\tensor{C}}{\vectr{\nu}}}$ or
$\fnof{W}{\fnof{\tensor{E}}{\vectr{\nu}}}$ is the strain energy
function. In component form we have
\begin{equation}
  S^{AB}=2\delby{W}{C_{AB}}
\end{equation}
or
\begin{equation}
  S^{AB}=\delby{W}{E_{AB}}
\end{equation}

Because $\tensor{C}$ is symmetric then we can deal with the invariants. The
three invariants are
\begin{equation}
  \begin{split}
    I_{1} &= \operatorname{tr}\tensor{C} \\
    &= C_{11} + C_{22} + C_{33} \\
    I_{2} &=
    \dfrac{1}{2}\pbrac{\pbrac{\operatorname{tr}\tensor{C}}^{2}-\operatorname{tr}\tensor{C}^{2}} \\
    &=
    \dfrac{1}{2}\left(\pbrac{C_{11}+C_{22}+C_{33}}^{2}\right. \\
      & \quad\left.-\pbrac{C_{11}^{2}+C_{12}C_{21}+C_{13}C_{31}+
        C_{21}C_{12}+C_{22}^{2}+C_{23}C_{32}+C_{31}C_{13}+C_{32}C_{23}+C_{33}^{2}}\right) \\
    I_{3} &= \det{\tensor{C}} \\
    &=C_{11}C_{22}C_{33}+C_{12}C_{23}C_{31}+C_{13}C_{21}C_{32}\\
    &\quad-C_{13}C_{22}C_{31}-C_{12}C_{21}C_{33}-C_{11}C_{23}C_{32}
  \end{split}
\end{equation}
We thus have
$\fnof{W}{\fnof{\tensor{C}}{\vectr{\nu}}}=\fnof{W}{I_{1},I_{2},I_{3}}$ and
thus
\begin{equation}
  S^{AB}=2\pbrac{\delby{W}{I_{1}}\delby{I_{1}}{C_{AB}}+\delby{W}{I_{2}}\delby{I_{2}}{C_{AB}}+\delby{W}{I_{3}}\delby{I_{3}}{C_{AB}}}
\end{equation}
or if we have
$\fnof{W}{\fnof{\tensor{E}}{\vectr{\nu}}}=\fnof{W}{I_{1},I_{2},I_{3}}$ and
thus
\begin{equation}
  S^{AB}=\pbrac{\delby{W}{I_{1}}\delby{I_{1}}{E_{AB}}+\delby{W}{I_{2}}\delby{I_{2}}{E_{AB}}+\delby{W}{I_{3}}\delby{I_{3}}{E_{AB}}}
\end{equation}

Now we have
\begin{equation}
  \delby{I_{1}}{C_{AB}}=\begin{bmatrix}
    1 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{bmatrix}
\end{equation}
and
\begin{equation}
  \delby{I_{2}}{C_{AB}}=\begin{bmatrix}
    C_{22}+C_{33} & -C_{21} & -C_{31} \\
    -C_{12} & C_{11}+C_{33} & -C_{32} \\
    -C_{13} & -C_{23} & C_{11}+C_{22}
  \end{bmatrix}
\end{equation}
and
\begin{equation}
  \delby{I_{3}}{C_{AB}}=\begin{bmatrix}
    C_{22}C_{33}-C_{23}C_{32} & C_{23}C_{31}-C_{21}C_{33} & C_{23}C_{32}-C_{22}C_{31} \\
    C_{13}C_{32}-C_{12}C_{33} & C_{11}C_{33}-C_{13}C_{31} & C_{12}C_{31}-C_{11}C_{32} \\
    C_{12}C_{32}-C_{22}C_{31} & C_{13}C_{23}-C_{11}C_{23} & C_{11}C_{22}-C_{12}C_{21}
  \end{bmatrix}
\end{equation}

\subsubsection{Mooney-Rivlin}

As an example consider a Mooney-Rivlin material. The strain energy function is
given by
\begin{equation}
  \fnof{W}{I_{1},I_{2}}=c_{1}\pbrac{I_{1}-3}+c_{2}\pbrac{I_{2}-3}
\end{equation}

The second Piola Kirchhoff tensor is thus
\begin{equation}
  S^{AB}=\begin{bmatrix}
    2c_{1}+2c_{2}\pbrac{C_{22}+C_{33}} & -2c_{2}C_{21} & -2c_{2}C_{31} \\
    -2c_{2}C_{12} & 2c_{1}+2c_{2}\pbrac{C_{11}+C_{33}} & -2c_{2}C_{32} \\
    -2c_{2}C_{13} & -2c_{2}C_{23} & 2c_{1}+2c_{2}\pbrac{C_{11}+C_{22}}
  \end{bmatrix}
\end{equation}
or
\begin{equation}
  S^{AB}=\begin{bmatrix}
    c_{1}+c_{2}\pbrac{E_{22}+E_{33}} & -c_{2}E_{21} & -c_{2}E_{31} \\
    -c_{2}E_{12} & c_{1}+c_{2}\pbrac{E_{11}+E_{33}} & -c_{2}E_{32} \\
    -c_{2}E_{13} & -c_{2}E_{23} & c_{1}+c_{2}\pbrac{E_{11}+E_{22}}
  \end{bmatrix}
\end{equation}

\section{Uniaxial extension of a unit cube}

Consider a uniaxial stretch of $\alpha$ of a unit cube in the $x$
direction. The resulting deformed configuration will be a cube of dimensions
$X$, $Y$ and $Z$.

Here the deformation gradient tensor will be
\begin{equation}
  \tensor{F}= \begin{bmatrix}
    1+\alpha & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{bmatrix}
\end{equation}
everywhere, and the Jacobian of transformation will be 
\begin{equation}
  J = \det{\tensor{F}}=1+\alpha
\end{equation}

The right Cauchy-Green tensor will be
\begin{equation}
  \tensor{C} = \transpose{\tensor{F}}\tensor{F} = \begin{bmatrix}
    1+\alpha & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{bmatrix} \begin{bmatrix}
    1+\alpha & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{bmatrix} = \begin{bmatrix}
    \pbrac{1+\alpha}^2 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{bmatrix}
\end{equation}

And the Lagrange strain tensor will be
\begin{equation}
  \tensor{E} = \frac{1}{2}\pbrac{\tensor{C}-\tensor{I}} = \frac{1}{2}\pbrac{\begin{bmatrix}
    \pbrac{1+\alpha}^2 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{bmatrix} - \begin{bmatrix}
    1 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{bmatrix}} = \begin{bmatrix}
    \alpha+\frac{\alpha^2}{2} & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{bmatrix}
\end{equation}

The Finger strain tensor is thus
\begin{equation}
  \tensor{f} = \inverse{\tensor{C}} =  \begin{bmatrix}
    \frac{1}{\pbrac{1+\alpha}^2} & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
  \end{bmatrix}
\end{equation}

The second Piola-Kirchoff stress tensor will be
\begin{equation}
  \begin{split}
    \tensor{S} &= \begin{bmatrix}
      2c_{1}+2c_{2}\pbrac{C_{22}+C_{33}} & -2c_{2}C_{21} & -2c_{2}C_{31} \\
      -2c_{2}C_{12} & 2c_{1}+2c_{2}\pbrac{C_{11}+C_{33}} & -2c_{2}C_{32} \\
      -2c_{2}C_{13} & -2c_{2}C_{23} & 2c_{1}+2c_{2}\pbrac{C_{11}+C_{22}}
    \end{bmatrix} \\
    &= \begin{bmatrix}
      2c_{1}+4c_{2} & 0 & 0 \\
      0 & 2c_{1}+2c_{2}\pbrac{\pbrac{1+\alpha}^2+1} & 0 \\
      0 & 0 & 2c_{1}+2c_{2}\pbrac{\pbrac{1+\alpha}^2+1}
    \end{bmatrix}
  \end{split}
\end{equation}
and the Kirchoff stress tensor will be
\begin{equation}
  \begin{split}
    \tensor{\tau}&=\tensor{F}\tensor{S}\transpose{\tensor{F}} \\
    &= \begin{bmatrix}
      1+\alpha & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1
    \end{bmatrix} \begin{bmatrix}
      2c_{1}+4c_{2} & 0 & 0 \\
      0 & 2c_{1}+2c_{2}\pbrac{\pbrac{1+\alpha}^2+1} & 0 \\
      0 & 0 & 2c_{1}+2c_{2}\pbrac{\pbrac{1+\alpha}^2+1}
    \end{bmatrix}\begin{bmatrix}
      1+\alpha & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1
    \end{bmatrix} \\
    &= \begin{bmatrix}
      \pbrac{2c_{1}+4c_{2}}\pbrac{1+\alpha}^2 & 0 & 0 \\
      0 & 2c_{1}+2c_{2}\pbrac{\pbrac{1+\alpha}^2+1} & 0 \\
      0 & 0 & 2c_{1}+2c_{2}\pbrac{\pbrac{1+\alpha}^2+1}
    \end{bmatrix}
  \end{split}  
\end{equation}

The Cauchy stress tensor is thus
\begin{equation}
  \tensor{\sigma} = \frac{\tensor{\tau}}{J}= \begin{bmatrix}
    \pbrac{2c_{1}+4c_{2}}\pbrac{1+\alpha} & 0 & 0 \\
    0 & \frac{2c_{1}+2c_{2}\pbrac{\pbrac{1+\alpha}^2+1}}{1+\alpha} & 0 \\
    0 & 0 & \frac{2c_{1}+2c_{2}\pbrac{\pbrac{1+\alpha}^2+1}}{1+\alpha}
  \end{bmatrix}
\end{equation}

The Cauchy tensor resulting from hydrostatic pressure is 
\begin{equation}
  \tensor{\sigma}_{p}= p\tensor{I}=\begin{bmatrix}
    p & 0 & 0 \\
    0 & p & 0 \\
    0 & 0 & p
  \end{bmatrix}
\end{equation}

\subsection{Old Stuff}

Formulation of finite element equations for finite elasticity (large
deformation mechanics) implemented in OpenCMISS is based on the
\textit{\textbf{principle of virtual work}}. The finite element model consists
of a set of non-linear algebraic equations. Non-linearity of equations stems
from non-linear stress-strain relationship and quadratic terms present in the
strain tensor. A typical problem in large deformation mechanics involves
determination of the deformed geometry or mesh nodal parameters, from the
finite element point of view, of the continuum from a known undeformed
geometry, subject to boundary conditions and satisfying stress-strain
(constitutive) relationship.
  
The boundary conditions can be either \textit{\textbf{Dirichlet}}
(displacement), \textit{\textbf{Neumann}} (force) or a combination of them,
known as the mixed boundary conditions. Displacement boundary conditions are
generally nodal based. However, force boundary conditions can take any of the
following forms or a combination of them - nodal-based, distributed load
(e.g. pressure) or force acting at a discrete point on the boundary. In the
latter two forms, the equivalent nodal forces are determined using the
\textit{\textbf{method of work equivalence}} \cite{hutton:2004} and the forces
so obtained will then be added to the right hand side or the residual vector
of the linear equation system.

There are a numerous ways of describing the mechanical characteristics of
deformable materials in large deformation mechanics or finite elasticity
analyses. A predominantly used form for representing constitutive properties
is a strain energy density function. This model gives the energy required to
deform a unit volume (hence energy density) of the deformable continuum as a
function of Green-Lagrange strain tensor components or its derived variables
such as invariants or principal stretches. A material that has a strain energy
density function is known as a \textit{\textbf{hyperelastic}} or
\textit{\textbf{Green-elastic material}}.

The deformed equilibrium state should also give the minimum total elastic
potential energy. One can therefore formulate finite element equations using
the \textit{\textbf{Variational method}} approach where an extremum of a
functional (in this case total strain energy) is determined to obtain mesh
nodal parameters of the deformed continuum. It is also possible to derive the
finite element equations starting from the governing equilibrium equations
known as Cauchy equation of motion. The weak form of the governing equations
is obtained by multiplying them with suitable weighting functions and
integrating over the domain (method of weighted residuals). If interpolation
or shape functions are used as weighting functions, then the method is called
the Galerkin finite element method. All three approaches (virtual work,
variational method and Galerkin formulation) result in the same finite element
equations.

In the following sections the derivation of kinematic relationships of
deformation, energy conjugacy, constitutive relationships and final form the
finite element equations using the virtual work approach will be discussed in
detail.

\subsubsection{Kinematics of Deformation}
In order to track the deformation of an infinitesimal length at a particle of
the continuum, two coordinates systems are defined. An arbitrary orthogonal
spatial coordinate system, which is fixed in space and a material coordinate
system which is attached to the continuum and deforms with the continuum. The
material coordinate system, in general, is a curvi-linear coordinate system
but must have mutually orthogonal axes at the undeformed state. However, in
the deformed state, these axes are no longer orthogonal as they deform with
the continuum (fig 1). In addition to these coordinate systems, there exist
finite element coordinate systems (one for each element) as well. These
coordinates are normalised and vary from 0.0 to 1.0. The following notations are used to represent various coordinate systems and coordinates of a particle of the continuum.\\

\noindent $Y_{1}$-$Y_{2}$-$Y_{3}$ - fixed spatial coordinate system axes - orthogonal\\
$N_{1}$-$N_{2}$-$N_{3}$ - deforming material coordinate system axes  - orthogonal in the undeformed state\\
$\Xi_{1}$-$\Xi_{2}$-$\Xi_{3}$ - element coordinate system - non-orthogonal in general and deforms with continuum\\

\noindent $x_{1}$-$x_{2}$-$x_{3}$ [$\vect{x}$] - spatial coordinates of a particle in the undeformed state wrt $Y_{1}$-$Y_{2}$-$Y_{3}$ CS \\
$z_{1}$-$z_{2}$-$z_{3}$ [$\vect{z}$] - spatial coordinates of the same particle in the deformed state wrt $Y_{1}$-$Y_{2}$-$Y_{3}$ CS \\
$\nu_{1}$-$\nu_{2}$-$\nu_{3}$ [$\vect{\nu}$] - material coordinates of the particle wrt $N_{1}$-$N_{2}$-$N_{3}$ CS (these do not change) \\
$\xi_{1}$-$\xi_{2}$-$\xi_{3}$ [$\vect{\xi}$] - element coordinates of the particle wrt $\Xi_{1}$-$\Xi_{2}$-$\Xi_{3}$ CS (these too do not change)\\

Since the directional vectors of the material coordinate system at any given
point in the undeformed state is mutually orthogonal, the relationship between
spatial $\vect{x}$ and material $\vect{\nu}$ coordinates is simply a
rotation. The user must define the undeformed material coordinate
system. Typically a nodal based interpolatable field known as fibre
information (fibre, imbrication and sheet angles) is input to OpenCMISS. These
angles define how much the \textit{\textbf{reference or default material
    coordinate system}} must be rotated about the reference material axes. The
reference material coordinate system at a given point is defined as
follows. The first direction $\nu_{1}$ is in the $\xi_{1}$ direction. The
second direction, $\nu_{2}$ is in the $\xi_{1}-\xi_{2}$ plane but orthogonal
to $\nu_{1}$. Finally the third direction $\nu_{3}$ is determined to be normal
to both $\nu_{1}$ and $\nu_{2}$. Once the reference coordinate system is
defined, it is then rotated about $\nu_{3}$ by an angle equal to the
interpolated fibre value at the point in counter-clock wise direction. This
will be followed by a rotation about new $\nu_{2}$ axis again in the
counter-clock wise direction by an angle equal to the sheet value. The final
rotation is performed about the current $\nu_{1}$ by an angle defined by
interpolated sheet value. Note that before a rotation is carried out about an
arbitrary axis one must first align(transform) the axis of rotation with one
of the spatial coordinate system axes. Once the rotation is done, the rotated
coordinate system (material) must be inverse-transformed.

Having defined the undeformed orthogonal material coordinate system, the
metric tensor $\delby{\vect{x}}{\vect{\nu}}$ can be determined. As mentioned,
the tensor $\delby{\vect{x}}{\vect{\nu}}$ contains rotation required to align
material coordinate system with spatial coordinate system. This tensor is
therefore orthogonal. A similar metric tensor can be defined to relate the
deformed coordinates $\vect{z}$ of the point to its material coordinates
$\vect{\nu}$. Note that the latter coordinates do not change as the continuum
deforms and more importantly this tensor is not orthogonal as well. The metric
tensor, $\delby{\vect{z}}{\vect{\nu}}$ is called the
\textit{\textbf{deformation gradient tensor}} and denoted as $\matr{F}$.

\begin{equation}
  \matr{F}=\delby{\vect{z}}{\vect{\nu}}
  \label{eqn:deformationgradienttensor}
\end{equation}
 
It can be shown that the deformation gradient tensor contains rotation when an
infinitesimal length $\vect{dr_{0}}$ in the undeformed state undergoes
deformation. Since rotation does not contribute to any strain, it must be
removed from the deformation gradient tensor. Any tensor can be decomposed
into an orthogonal tensor and a symmetric tensor (known as polar
decomposition). In other words, the same deformation can be achieved by first
rotating $\vect{dr}$ and then stretching (shearing and scaling) or
vice-verse. Thus, the deformation gradient tensor can be given by,

\begin{equation}
  \matr{F}=\delby{\vect{z}}{\vect{\nu}}=\matr{R}\matr{U}=\matr{V}\matr{R_{1}}
  \label{eqn:polardecomposition}
\end{equation}
 
The rotation present in the deformation gradient tensor can be removed either
by right or left multiplication of $\matr{F}$. The resulting tensors lead to
different strain measures. The right Cauchy deformation tensor $\matr{C}$ is
obtained from,

\begin{equation}
  \matr{C}=\transpose{[\matr{R}\matr{U}]}[\matr{R}\matr{U}]=\transpose{\matr{U}}\transpose{\matr{R}}\matr{R}\matr{U}=\transpose{\matr{U}}\matr{U}
  \label{eqn:rightCauchy}
\end{equation}

Similarly the left Cauchy deformation tensor or the Finger tensor \matr{B} is
obtained from the left multiplication of \matr{F},

\begin{equation}
  \matr{B}=[\matr{V}\matr{R_{1}}]\transpose{[\matr{V}\matr{R_{1}}]}=\matr{V}\matr{R_{1}}\transpose{\matr{R_{1}}}\transpose{\matr{V}}=\matr{V}\transpose{\matr{V}}
  \label{eqn:leftCauchy}
\end{equation}

\noindent Note that both $\matr{R}$ and $\matr{R_{1}}$ are orthogonal tensors
and therefore satisfy the following condition,

\begin{equation}
  \transpose{\matr{R}}\matr{R}=\matr{R_{1}}\transpose{\matr{R_{1}}}=\matr{I}
  \label{eqn:orthoganality}
\end{equation}

Since there is no rotation present in both $\matr{C}$ and $\matr{B}$, they can
be used to define suitable strain measures as follows,

\begin{equation}
  \matr{E}=\frac{1}{2}\pbrac{\transpose{\delby{\vect{z}}{\vect{\nu}}}\delby{\vect{z}}{\vect{\nu}}-
                       \transpose{\delby{\vect{x}}{\vect{\nu}}}\delby{\vect{x}}{\vect{\nu}}}=
	    \frac{1}{2}(\matr{C}-\matr{I})	       
  \label{eqn:greenstrain}
\end{equation}

\noindent and

\begin{equation}
  \vect{e}=\frac{1}{2}\bbrac{\pbrac{\delby{\vect{x}}{\vect{\nu}}\transpose{\delby{\vect{x}}{\vect{\nu}}}}^{-1}-
                             \pbrac{\delby{\vect{z}}{\vect{\nu}}\transpose{\delby{\vect{z}}{\vect{\nu}}}}^{-1}}=
			     \frac{1}{2}\pbrac{\matr{I}-\matr{B}^{-1}}  
  \label{eqn:almansistrain}
\end{equation}

\noindent where $\matr{E}$ and $\vect{e}$ are called Green and Almansi strain tensors respectively. 
Also note that $\delby{\vect{x}}{\vect{\nu}}$ is an orthogonal tensor. \\

It is now necessary to establish a relationship between strain and displacement. Referring to figure 1, 

\begin{equation}
  \vect{z}=\vect{x}+\vect{u}
  \label{eqn:displacement}
\end{equation}

\noindent where \vect{u} is the displacement vector. \\

\noindent Differentiating \eqnref{eqn:displacement} using the chain rule,

\begin{equation}
  \delby{\vect{z}}{\vect{\nu}}=\delby{\vect{x}}{\vect{\nu}}+\delby{\vect{u}}{\vect{x}}\delby{\vect{x}}{\vect{\nu}}=
                               \pbrac{\matr{I}+\delby{\vect{u}}{\vect{x}}}\delby{\vect{x}}{\vect{\nu}}  
  \label{eqn:displacementgradient}
\end{equation}

\noindent Substituting \eqnref{eqn:displacementgradient} into \eqnref{eqn:greenstrain},

\begin{equation}
  \matr{E}=\frac{1}{2}\bbrac{\transpose{\delby{\vect{x}}{\vect{\nu}}}\transpose{\pbrac{\matr{I}+\delby{\vect{u}}{\vect{x}}}}
                  \pbrac{\matr{I}+\delby{\vect{u}}{\vect{x}}}\delby{\vect{x}}{\vect{\nu}}-\matr{I}}
  \label{eqn:greendisplacement1}
\end{equation}

\noindent Simplifying,

\begin{equation}
  \matr{E}=\frac{1}{2}\transpose{\delby{\vect{x}}{\vect{\nu}}}
           \pbrac{\delby{\vect{u}}{\vect{x}}+\transpose{\delby{\vect{u}}{\vect{x}}}+
	   \transpose{\delby{\vect{u}}{\vect{x}}}\delby{\vect{u}}{\vect{x}}}
	   \delby{\vect{x}}{\vect{\nu}}
  \label{eqn:greendisplacement2}
\end{equation}
 
As can be seen from \eqnref{eqn:greendisplacement2} the displacement gradient
tensor $\delby{\vect{u}}{\vect{x}}$ is defined with respect to undeformed
coordinates $\vect{x}$. This means that the strain tensor $\matr{E}$ has
Lagrangian description and hence it is also also called the Green-Lagrange
strain tensor.
 
A similar derivation can be employed to establish a relationship between the
Almansi and displacement gradient tensors and the final form is given by,

\begin{equation}
  \vect{e}=\frac{1}{2}\delby{\vect{u}}{\vect{z}}+\transpose{\delby{\vect{u}}{\vect{z}}}-
	   \transpose{\delby{\vect{u}}{\vect{z}}}\delby{\vect{u}}{\vect{z}}
  \label{eqn:almansidisplacement}
\end{equation}
 
The displacement gradient tensor terms in \eqnref{eqn:almansidisplacement} are defined with respect to deformed coordinates $\vect{z}$ and
therefore the strain tensor has Eulerian description. Thus it is also known as the Almansi-Euler strain tensor.

\subsubsection{Energy Conjugacy}



\subsubsection{Constitutive models}



\subsubsection{Principle of Virtual Work}
Elastic potential energy or simply elastic energy associated with the
deformation can be given by strain and its energetically conjugate stress.
Note that the Cauchy stress and Almansi-Euler strain tensors and Second
Piola-Kirchhoff (2PK) and Green-Lagrange tensors are energetically
conjugate. Thus, the \textit{\textbf{total internal energy}} due to strain in
the body at the deformed state (fig. 3.1) can be given by,
 
\begin{equation}
  W_{int}=\gint{0}{v}{(\vect{e}:\vect{\sigma})}v
  \label{eqn:totalenergy}
\end{equation}

where \vect{e} and \vect{\sigma} are Almansi strain tensor and Cauchy stress
tensor respectively.

If the deformed body is further deformed by introducing virtual displacements,
then the new internal elastic energy can be given by,

\begin{equation}
  {W_{int}+\delta W_{int}}=\gint{0}{v}{[\vect{(e+\delta{e})}:\vect{\sigma}]}v
  \label{eqn:virtualtotalenergy}
\end{equation}

Deducting \eqnref{eqn:totalenergy} from \eqnref{eqn:virtualtotalenergy},

\begin{equation}
  \delta W_{int}=\gint{0}{v}{\pbrac{\vect{\delta \epsilon} : \vect{\sigma}}}v
  \label{eqn:virtualenergy}
\end{equation}

Using \eqnref{eqn:almansidisplacement} for virtual strain,

\begin{equation}
  \vect{\delta e}=\delby{\vect{\delta u}}{\vect{z}} + \transpose{\delby{\vect{\delta u}}{\vect{z}}} + 
                  \transpose{\delby{\vect{\delta u}}{\vect{z}}}\delby{\vect{\delta u}}{\vect{z}}
  \label{eqn:virtualalmansidisplacement}
\end{equation}

Since virtual displacements are infinitesimally small, quadratic terms in
\eqnref{eqn:virtualalmansidisplacement} can be neglected.  The resulting
strain tensor, known as small strain tensor \vect{\epsilon}, can be given as,

\begin{equation}
  \vect{\delta \epsilon}=\delby{\vect{\delta u}}{\vect{z}} + \transpose{\delby{\vect{\delta u}}{\vect{z}}} 
  \label{eqn:virtualsmalldisplacement}
\end{equation}
 
Since both $\vect{\sigma}$ and $\vect{\delta \epsilon}$ are symmetric, new
vectors are defined by inserting tensor components as follows,

\begin{equation}
  \vect{\delta \epsilon}=\transpose{\sqbrac{\delta \epsilon_{11} \hspace{4 pt} \delta \epsilon_{22} \hspace{4 pt} \delta \epsilon_{33} 
      \hspace{4 pt} 2\delta \epsilon_{12} \hspace{4 pt} 2\delta \epsilon_{23} \hspace{4 pt} 2\delta \epsilon_{13}}} :
  \vect{\sigma}=\transpose{\sqbrac{\delta \sigma_{11} \hspace{4 pt} \delta \sigma_{22} \hspace{4 pt} \delta \sigma_{33} 
      \hspace{4 pt} 2\delta \sigma_{12} \hspace{4 pt} 2\delta \sigma_{23} \hspace{4 pt} 2\delta \sigma_{13} }}	  		  
  \label{eqn:newvectors}
\end{equation} 

Substituting \eqnref{eqn:newvectors} into \eqnref{eqn:virtualenergy},

\begin{equation}
  \delta W_{int}=\gint{0}{v}{\pbrac{\transpose{\vect{\delta \epsilon}} \vect{\sigma}}}v
  \label{eqn:virtualenergy1}
\end{equation}

The strain vector $\vect{\delta \epsilon}$ can be related to displacement
vector using the following equation,

\begin{equation}
  \vect{\delta \epsilon}=\matr{D} \vect{\delta u} 
  \label{eqn:virtualsmalldisplacement1}
\end{equation}

\noindent where $\matr{D}$ and $\vect{u}$ are linear differential operator and
displacement vector respectively and given by,

\begin{equation}
  \begin{array}{c} \matr{D} \end{array} =
  \pbrac{ \begin{array}{ccc} \delby{}{z_{1}} & 0 & 0 \\ 
      0 & \delby{}{z_{2}} & 0 \\
      0 & 0 & \delby{}{z_{3}} \\
      \delby{}{z_{2}} & \delby{}{z_{1}} & 0 \\ 
      0 & \delby{}{z_{3}} & \delby{}{z_{2}} \\ 
      \delby{}{z_{3}} & 0 & \delby{}{z_{1}} \\ \end{array} }
  \label{eqn:differentialoperator}
\end{equation}

\begin{equation}
  \vect{\delta u}=\transpose{\pbrac{\delta u_{1} \hspace{4 pt} \delta u_{2} \hspace{4 pt} \delta u_{3}}}
  \label{eqn:displacementvector}
\end{equation}

The virtual displacement is a finite element field and hence the value at any
point can be obtained by interpolating nodal virtual displacements.

\begin{equation}
  \vect{\delta u}=\matr{\Phi}\matr{\Delta}
  \label{eqn:interpolation}
\end{equation}

