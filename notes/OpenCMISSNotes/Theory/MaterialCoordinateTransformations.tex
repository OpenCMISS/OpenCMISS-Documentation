\section{Material Coordinate Transformations}
\label{sec:MaterialCoordinateTransformations}

\subsection{Two dimensions}
\label{subsec:MaterialCoordinateTransformationsTwoD}

Consider the two dimensional system shown in
\figref{fig:MaterialCoordinateTransformationTwoD}. There are three
coordinate systems of interest. The first is the geometric coordinate
system, $\vectr{x}$, and the second is the $\vectr{\xi}$ coordinate
system of an element. The final coordinate system is the $\vectr{\nu}$
coordinate system of the material fibre directions.

\epstexfigure{Theory/svgs/TwoDMaterialTransformation.eps_tex}{Two
  dimensional material coordinate transformation.}{Two dimensional
  material coordinate
  transformation.}{fig:MaterialCoordinateTransformationTwoD}{0.5}

To work out the transformations between these coordinate systems we
first define the geometric position vector (with respect to the base vectors $\generalbasevector_{i}$) of a point inside the element
using interpolation \ie
\begin{equation}
  \fnof{\vectr{x}}{\vectr{\xi}}=\fnof{x^{i}}{\vectr{\xi}}\generalbasevector_{i}=
  \gsf{n}{\beta}\gbfn{n}{\beta}{\vectr{\xi}}\nodedof{\vectr{x}}{n}{\beta}
\end{equation}

We can now differentiate the geometric interpolation to find the tangent direction with respect to $\xione$. We define the normalisation of this direction as the vector, $\vectr{a}$, \ie
\begin{equation}
  \fnof{\vectr{a}}{\vectr{\xi}}=\fnof{a^{i}}{\vectr{\xi}}\generalbasevector_{i}=\norm{\delby{\fnof{\vectr{x}}{\vectr{\xi}}}{\xione}}
\end{equation}

We now define the vector, $\vectr{b}$, to be orthogonal to the vector, $\vectr{a}$, by rotating $\vectr{a}$ counter clockwise
$90\degree$ \ie
\begin{equation}
  \fnof{\vectr{b}}{\vectr{\xi}}=\fnof{b^{i}}{\vectr{\xi}}\generalbasevector_{i}=
  \fnof{a^{2}}{\vectr{\xi}}\generalbasevector_{1}-\fnof{a^{1}}{\vectr{\xi}}\generalbasevector_{2}
\end{equation}

Now the material fibre direction is defined by a rotation angle,
$\theta$, from the $\xione$ direction. This angle is given by
interpolation within the element \ie
\begin{equation}
  \fnof{\theta}{\vectr{\xi}}=\gsf{o}{\gamma}\gbfn{o}{\gamma}{\vectr{\xi}}\nodedof{\vectr{\theta}}{o}{\gamma}
\end{equation}

We can now find the fibre vector, $\vectr{f}$, and sheet vector,
$\vectr{s}$, by rotating the vectors $\vectr{a}$ and $\vectr{b}$ by
$\theta$. To do this we make use of the rotation matrix
\begin{equation}
  \fnof{\matr{R}}{\fnof{\theta}{\vectr{\xi}}}=\begin{bmatrix}
  \cosine{\fnof{\theta}{\vectr{\xi}}} & \sine{\fnof{\theta}{\vectr{\xi}}} \\
  -\sine{\fnof{\theta}{\vectr{\xi}}} & \cosine{\fnof{\theta}{\vectr{\xi}}}
  \end{bmatrix}
\end{equation}
as
\begin{equation}
  \fnof{\vectr{f}}{\vectr{\xi}}=\fnof{f^{i}}{\vectr{\xi}}\generalbasevector_{i}=\fnof{\matr{R}}{\fnof{\theta}{\vectr{\xi}}}\fnof{\vectr{a}}{\vectr{\xi}}
\end{equation}
and
\begin{equation}
  \fnof{\vectr{s}}{\vectr{\xi}}=\fnof{s^{i}}{\vectr{\xi}}\generalbasevector_{i}=\fnof{\matr{R}}{\fnof{\theta}{\vectr{\xi}}}\fnof{\vectr{b}}{\vectr{\xi}}
\end{equation}
  
 
\subsection{Three dimensions}
\label{subsec:MaterialCoordinateTransformationsThreeD}
