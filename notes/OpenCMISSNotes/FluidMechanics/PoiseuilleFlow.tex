\section{Poiseuille Flow Equations}
\label{sec:PoiseuilleFlow}

\subsection{Governing equations:}
\label{subsec:PoiseuilleGoverningEquations}

The Poiseuille equation describes the pressure drop that occurs due to
viscous friction from laminar fluid flow over a straight
pipe. Consider the flow domain shown in
\figref{fig:PoiseuilleStraightPipe} and adopting a cylindrical polar
coordinate system.

\epstexfigure{FluidMechanics/svgs/cylindricaldomain.eps_tex}{Cylindrical
  domain of a straight pipe.}{Cylindrical domain of a straight pipe
  for Poiseuille flow. The pipe is of radius $r=R$ and length $z=L$. A
  cylindrical polar coordinate system $\pbrac{r,\theta,z}$ can be
  adopted with the fluid velocity is given by
  $\vectr{v}=\pbrac{v_{r},v_{\theta},v_{z}}$}{fig:PoiseuilleStraightPipe}{0.75}

In cylindrical coordinates the Navier-Stokes momentum equations for an incompressible Newtonian fluid are
\begin{multline}
  \rho\pbrac{\delby{v_{r}}{t}+v_{r}\delby{v_{r}}{r}+\dfrac{v_{\theta}}{r}\delby{v_{r}}{\theta}-\dfrac{v_{\theta}^{2}}{r}+
    v_{z}\delby{v_{r}}{z}}\\
  =-\delby{p}{r}+\mu\pbrac{\dfrac{1}{r}\delby{}{r}\pbrac{r\delby{v_{r}}{r}}-\dfrac{v_{r}}{r^{2}}+
    \dfrac{1}{r^{2}}\deltwosqby{v_{r}}{\theta}-\dfrac{2}{r^{2}}\delby{v_{\theta}}{\theta}+\deltwosqby{v_{r}}{z}}+
  \rho a_{g_{r}}
  \label{eqn:PoiseuilleRCylindricalNavierStokesMomentum}
\end{multline}
\begin{multline}
  \rho\pbrac{\delby{v_{\theta}}{t}+v_{r}\delby{v_{\theta}}{r}+\dfrac{v_{\theta}}{r}\delby{v_{\theta}}{\theta}-\dfrac{v_{r}v_{\theta}}{r}+
    v_{z}\delby{v_{\theta}}{z}}\\
  =-\dfrac{1}{r}\delby{p}{\theta}+\mu\pbrac{\dfrac{1}{r}\delby{}{r}\pbrac{r\delby{v_{\theta}}{r}}-
    \dfrac{v_{\theta}}{r^{2}}+\dfrac{1}{r^{2}}\deltwosqby{v_{\theta}}{\theta}+\dfrac{2}{r^{2}}\delby{v_{r}}{\theta}+
    \deltwosqby{v_{\theta}}{z}}+\rho a_{g_{\theta}}
  \label{eqn:PoiseuilleThetaCylindricalNavierStokesMomentum}
\end{multline}
\begin{multline}
  \rho\pbrac{\delby{v_{z}}{t}+v_{r}\delby{v_{z}}{r}+\dfrac{v_{\theta}}{r}\delby{v_{z}}{\theta}+v_{z}\delby{v_{z}}{z}}\\
  =-\delby{p}{z}+\mu\pbrac{\dfrac{1}{r}\delby{}{r}\pbrac{r\delby{v_{z}}{r}}+
   \dfrac{1}{r^{2}}\deltwosqby{v_{z}}{\theta}+\deltwosqby{u_{z}}{z}}+\rho a_{g_{z}}
  \label{eqn:PoiseuilleZCylindricalNavierStokesMomentum}
\end{multline}
and the Navier-Stokes conservation of mass equation for an incompressible Newtonian fluid in cylindrical coordinates is
\begin{equation}
  \dfrac{1}{r}\delby{\pbrac{rv_{r}}}{r}+\dfrac{1}{r}\delby{v_{\theta}}{\theta}+\delby{v_{z}}{z}=0
  \label{eqn:PoiseuilleCylindricalNavierStokesMass}
\end{equation}

Poiseuille flow can be derived from the Navier-Stokes equations in
cylindrical coordinates ($\vectr{u}=\pbrac{u_{r},u_{\theta},u_{x}}$)
by assuming that the flow is: \begin{enumerate}
  \setlength{\itemsep}{1pt} \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
\item Steady \ie $\delby{\vectr{u}}{t}=0$
\item The radial and swirl components of fluid velocity are zero \ie
  $u_{r}=u_{\theta}=0$ 
\item The flow is axisymmetric \ie $\delby{\vectr{u}}{\theta}=0$ and fully developed
  \ie $\delby{\vectr{u}}{x}=0$.
\end{enumerate}

The Poiseuille equation is:
\begin{equation}
  \addtolength{\fboxsep}{5pt}
  \boxed{
    \Delta{p}=\dfrac{8\mu LQ}{\pi R^{4}}
  }
  \label{eqn:Poiseuille_equation}
\end{equation}
where $\Delta{p}$ is the pressure drop along the pipe, $\mu$ is the viscosity $L$
is the length of the pipe $Q$ is volumetric flow and $R$ is the radius of the
pipe. 

Rearranging \eqnref{eqn:Poiseuille_equation} gives
\begin{equation}
  Q=\dfrac{\pi R^{2}R^{2}\Delta{p}}{8\mu L}
\end{equation}

Volumetric flow is average axisymmetric flow, $\bar{u}$, multipled by the area
of the pipe $A$ \ie $Q=\bar{u}A$. \Eqnref{eqn:Poiseuille_equation} now becomes
\begin{equation}
  \bar{u}A=\dfrac{AR^{2}}{8\mu}\Delta{p}
\end{equation}
or 
\begin{equation}
  \dfrac{R^{2}}{8\mu}\gradient{}{p}-\bar{u}=0
\end{equation}
as
\begin{equation}
  \dfrac{\Delta p}{L}=\delby{p}{x}=\gradient{}{p}
\end{equation}

\subsection{Weak formulation:}

The weak form of the differential form of the Poiseuille equation system
consisting of \eqnref{eqn:Poiseuille_equation} and can be written as:
\begin{equation}
  \gint{\Omega}{}{\pbrac{\dfrac{R^{2}}{8\mu}\gradient{}{p}-\bar{u}}w}{\Omega}=0
  \label{eqn:Poiseuilleweakform}
\end{equation}

\subsection{Finite element formulation:}
We can now discretise the domain into finite elements. \Eqnref{eqn:Poiseuilleweakform} becomes
\begin{equation}
  \dsum_{e=1}^{E}\gint{\Omega_{e}}{}{\pbrac{\frac{R^{2}}{8\mu}\gradient{}{p}-\bar{u}}w}{\Omega}=0
  \label{eqn:Poiseullefemform1}
\end{equation}
or
\begin{equation}
  \dsum_{e=1}^{E}\sqbrac{\gint{\Omega_{e}}{}{\pbrac{\frac{R^{2}}{8\mu}\gradient{}{p}w}{\Omega}-\gint{\Omega_{e}}{}{\bar{u}}w}{\Omega}}=0
  \label{eqn:Poiseullefemform2}
\end{equation}

We can now interpolate the dependent variables using basis functions
\begin{equation}
  \begin{split}
    \fnof{p}{\xi} &= \gbfn{n}{\beta}{\xi}\nodedof{p}{n}{\beta}\gsf{n}{\beta} \\
    \fnof{\bar{u}}{\xi} &= \elementdof{u}{e}
  \end{split}
\end{equation}

Using a Galerkin finite element approach (where the weighting functions are
chosen to be the interpolating basis functions) we have 
\begin{equation}
  \fnof{w}{\xi}=\gbfn{m}{\alpha}{\xi}\gsf{m}{\alpha}
\end{equation}

\subsection{Spatial integration:}

Adopting the standard integration notation we can write the spatial
integration term for each element in \eqnref{eqn:Poiseullefemform2} as
\begin{multline}
  \gint{0}{1}{\frac{R^{2}}{8\mu}\delby{\gbfn{n}{\beta}{\xi}\nodedof{p}{n}{\beta}\gsf{n}{\beta}}{\xi}
    \delby{\xi}{x}\gbfn{m}{\alpha}{\xi}\gsf{m}{\alpha}\abs{\fnof{J}{\xi}}}{\xi}- \\
  \gint{0}{1}{\elementdof{u}{e}\gbfn{m}{\alpha}{\xi}\gsf{m}{\alpha}\abs{\fnof{J}{\xi}}}{\xi}=\vectr{0}
  \label{eqn:Poiseullefemform1}
\end{multline}
or, taking the fixed degrees-of-freedom and scale factors outside the integrals, we have
\begin{multline}
  \frac{R^{2}}{8\mu}\gsf{m}{\alpha}\gsf{n}{\beta}\nodedof{p}{n}{\beta}\gint{0}{1}{\gbfn{m}{\alpha}{\xi}
    \delby{\gbfn{n}{\beta}{\xi}}{\xi}\delby{\xi}{x}\abs{\fnof{J}{\xi}}}{\xi}- \\
  \gsf{m}{\alpha}\elementdof{u}{e}\gint{0}{1}{\gbfn{m}{\alpha}{\xi}\abs{\fnof{J}{\xi}}}{\xi}=\vectr{0}
  \label{eqn:Poiseullefemform2}
\end{multline}

This is an elemental equation of the form
\begin{equation}
  K^{\alpha\beta}_{mn}\nodedof{p}{n}{\beta}-f^{\alpha}_{m}\elementdof{u}{e}=\vectr{0}
\end{equation}
or
\begin{equation}
  \left[ \begin{array}{cc}
      K^{\alpha\beta}_{mn} & -f^{\alpha}_{m} \\
      \transpose{\vectr{0}} & 0
    \end{array} \right] \left[ \begin{array}{c}
      \nodedof{p}{n}{\beta} \\
      \elementdof{u}{e}
    \end{array} \right] =  \left[ \begin{array}{c}
      \vectr{0} \\
      0
    \end{array} \right]
\end{equation}

The elemental stiffness matrix, $K^{\alpha\beta}_{mn}$, is given by
\begin{equation}
  K^{\alpha\beta}_{mn}=\frac{R^{2}}{8\mu}\gsf{m}{\alpha}\gsf{n}{\beta}
  \gint{0}{1}{\gbfn{m}{\alpha}{\xi}\delby{\gbfn{n}{\beta}{\xi}}{\xi}\delby{\xi}{x}
    \abs{\fnof{J}{\xi}}}{\xi}
  \label{eqn:elementalfemlhs1}
\end{equation}
and the elemental stiffness vector, $f^{\alpha}_{m}$, is given by
\begin{equation}
  f^{\alpha}_{m}=\gsf{m}{\alpha}\elementdof{u}{e}\gint{0}{1}{\gbfn{m}{\alpha}{\xi}
    \abs{\fnof{J}{\xi}}}{\xi}
  \label{eqn:elementalfemlhs2}
\end{equation}

Note that an additional conservation of mass equations are required to solve
the final matrix system.
