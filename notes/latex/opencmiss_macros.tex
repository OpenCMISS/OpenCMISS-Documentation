%
% Macros.tex - global macros file
%
% Created:
%   10 September 1996
%
% Updates:
%   Leo Cheng 31 May 1998, macros for DES software names
%   Leo Cheng 19 August 1998, added units for grams and kg
%   Leo Cheng 18 January 1999, added units for ohmcm
%   Leo Cheng 17 May 1999, adding modified url package and macros
%   Chris Bradley, 1 Dec 1999, adding \unitseparator.
%   Chris Bradley, 7 September 2000, Changed \lps to \Lps and \mMpLpms etc.
%     to \mmolpLpms etc.
%   Mark Trew, 8 June 2001. Made all macro arguments raised to a power
%     protected by {}, e.g. replaced #2^ with {#2}^.
%   Chris Bradley, 22 Feb 2011. Added svg figure support. 
%   Chris Bradley, 6 August 2014, Differential geometry support.
%   Chris Bradley, 4 July 2017, tidyup for outdated packages.

%
% Necessary packages
%
\usepackage{alltt}
\usepackage[centertags]{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{calc}
\usepackage{graphicx}
\usepackage{epsfig}
\usepackage{ifthen}
\usepackage{xspace}
\usepackage{url}

%
% URL commands
%
\newcommand{\email}     {\begingroup \urlstyle{sf}\Url}
\newcommand{\directory} {\begingroup \urlstyle{sf}\Url}
\newcommand{\file}      {\begingroup \urlstyle{sf}\Url}
\renewcommand{\url}     {\begingroup \urlstyle{sf}\Url}

%
% Software and systmes
%
\newcommand{\OpenCMISS} {\textsf{OpenCMISS}\xspace}
\newcommand{\CMISS} {\textsf{CMISS}\xspace}
\newcommand{\CM}    {\textsf{CM}\xspace}       %note upper case to distinguish from centimeters
\newcommand{\CMGUI} {\textsf{CMGUI}\xspace}
\newcommand{\UNEMAP}{\textsf{UnEmap}\xspace}
\newcommand{\FieldML}{\textsf{FieldML}\xspace}
\newcommand{\CellML}{\textsf{CellML}\xspace}

%
% New commands
%
\newcommand{\Index}[1]{#1\index{#1}}
\newcommand{\subsubsubsection}[1]{\noindent\textbf{#1}}
%\newcommand{\newabbrev}[2]{\newcommand{#1}{#2\xspace}}
%\newcommand{\newabbrevs}[3]{\newcommand{#1}{#2\xspace}\newcommand{#3}{#2s\xspace}}
\newcommand{\clearemptydoublepage}{\newpage{\pagestyle{empty}\cleardoublepage}}
%\newcommand{\newion}[3]{\newcommand{#1}{\ion{#2}{#3}}} % new ion
%\newcommand{\newunit}[2]{\newcommand{#1}{\units{#2}}} % new unit

%
% New enironments
%
\newenvironment{code}[0]{\small\begin{alltt}}{\end{alltt}\normalsize}

%
% Figures etc.
%
\newcommand{\pdftexfigure}[5]{ %
  \begin{figure}[htbp] \centering %
   \ifthenelse{\equal{#5}{}}{ %
      \def\svgwidth{\columnwidth}}{ %
      \def\svgscale{#5} %
    } %
    \input{#1} %
    \ifthenelse{\equal{#2}{}}{ %
      \caption{#3}}{ %
      \caption[#2]{#3} %
      } %
    \label{#4} %
  \end{figure} %
  } % pdftex figure i.e. inkscape svgs
    % e.g. \pdftexfigure{figure}{short caption}{long caption}{label}{scale}
    % or \pdftexfigure{figure}{}{caption}{label}{}

\newcommand{\epstexfigure}[5]{ %
  \begin{figure}[htbp] \centering %
    \ifthenelse{\equal{#5}{}}{ %
      \def\svgwidth{\columnwidth}}{ %
      \def\svgscale{#5} %
    } %
    \input{#1} %
    \ifthenelse{\equal{#2}{}}{ %
      \caption{#3}}{ %
      \caption[#2]{#3} %
    } %
    \label{#4} %
  \end{figure} %
  } % epstex figure i.e. inkscape svgs
  % e.g. \epstexfigure{figure}{short caption}{long caption}{label}{scale}
  % or \epstexfigure{figure}{}{caption}{label}{}
  
\newcommand{\pstexfigure}[5]{ %
  \begin{figure}[htbp] \centering %
    \ifthenelse{\equal{#5}{}}{ %
      \def\svgwidth{\columnwidth}}{ %
      \def\svgscale{#5} %
    } %
    \input{#1} %
    \ifthenelse{\equal{#2}{}}{ %
      \caption{#3}}{ %
      \caption[#2]{#3} %
      } %
    \label{#4} %
  \end{figure} %
  } % pstex figure i.e. inkscape, xfig or gnuplot
    % e.g. \pstexfigure{figure}{short caption}{long caption}{label}{scale}
    % or \pstexfigure{figure}{}{caption}{label}{}

\newcommand{\epsfigure}[4]{ %
  \incgrfigure{}{#1}{#2}{#3}{#4}
  } % eps figure
    % e.g. \epsfigure{epsfig options}{short caption}{long caption}{label}
    % or \epsfigure{epsfig options}{}{caption}{label}

\newcommand{\incgrfigure}[5]{ %
  \begin{figure}[htbp] \centering %
    \includegraphics[#1]{#2} %
    \ifthenelse{\equal{#3}{}}{ %
      \ifthenelse{\equal{#4}{}}{
        {}{ %
          \caption{#4}
        }}{
        \caption[#3]{#4} %
      }} %
    \label{#5} %
  \end{figure} %
  } % include graphics figure
    % e.g. \incgrfigure{height/width options}{epsfig options}{short caption}
    %                  {long caption}{label}
    % or \incgrfigure{height/width options}{epsfig options}{}{caption}{label}

%
% Formats for references to equations, tables etc.
%
\newcommand{\appendref}[1]{Appendix~\ref{#1}} % Appendix reference
\newcommand{\Appendref}[1]{Appendix~\ref{#1}} % Appendix reference
\newcommand{\appendrefs}[2]{Appendices~\ref{#1} and~\ref{#2}} % Appendices ref.
\newcommand{\Appendrefs}[2]{Appendices~\ref{#1} and~\ref{#2}} % Appendices ref.
\newcommand{\appendthrurefs}[2]{Appendices~\ref{#1}--\ref{#2}} % Appendices--
\newcommand{\Appendthrurefs}[2]{Appendices~\ref{#1}--\ref{#2}} % Appendices--
\newcommand{\bref}[1]{(\ref{#1})} % bracketed () reference
\newcommand{\chapref}[1]{Chapter~\ref{#1}} % Chapter reference
\newcommand{\Chapref}[1]{Chapter~\ref{#1}} % Chapter reference
\newcommand{\chaprefs}[2]{Chapters~\ref{#1} and~\ref{#2}} % Chapters reference
\newcommand{\Chaprefs}[2]{Chapters~\ref{#1} and~\ref{#2}} % Chapters reference
\newcommand{\chathrurefs}[2]{Chapters~\bref{#1}--\bref{#2}} % Chapters-- ref.
\newcommand{\Chathrurefs}[2]{Chapters~\bref{#1}--\bref{#2}} % Chapters-- ref.
\newcommand{\eqnref}[1]{Equation~\bref{#1}} % Equation reference
\newcommand{\Eqnref}[1]{Equation~\bref{#1}} % Equation reference
\newcommand{\eqnrefs}[2]{Equations~\bref{#1} and~\bref{#2}} % Equations ref.
\newcommand{\Eqnrefs}[2]{Equations~\bref{#1} and~\bref{#2}} % Equations ref.
\newcommand{\eqnthrurefs}[2]{Equations~\bref{#1}--\bref{#2}} % Equations-- ref.
\newcommand{\Eqnthrurefs}[2]{Equations~\bref{#1}--\bref{#2}} % Equations-- ref.
\newcommand{\figref}[1]{Figure~\ref{#1}} % Figure reference
\newcommand{\Figref}[1]{Figure~\ref{#1}} % Figure reference
\newcommand{\figrefs}[2]{Figures~\ref{#1} and~\ref{#2}} % Figures reference
\newcommand{\Figrefs}[2]{Figures~\ref{#1} and~\ref{#2}} % Figures reference
\newcommand{\figthrurefs}[2]{Figures~\bref{#1}--\bref{#2}} % Figures-- ref.
\newcommand{\Figthrurefs}[2]{Figures~\bref{#1}--\bref{#2}} % Figures-- ref.
\newcommand{\pagref}[1]{page~\pageref{#1}} % page reference
\newcommand{\Pagref}[1]{Page~\pageref{#1}} % Page reference
\newcommand{\pagrefs}[2]{pages~\pageref{#1} and~\pageref{#2}} % pages reference
\newcommand{\Pagrefs}[2]{Pages~\pageref{#1} and~\pageref{#2}} % Pages reference
\newcommand{\pagthrurefs}[2]{pages~\pageref{#1}--\pageref{#2}} % pages--
\newcommand{\Pagthrurefs}[2]{Pages~\pageref{#1}--\pageref{#2}} % Pages--
\newcommand{\secref}[1]{Section~\ref{#1}} % Section reference
\newcommand{\Secref}[1]{Section~\ref{#1}} % Section reference
\newcommand{\secrefs}[2]{Sections~\ref{#1} and~\ref{#2}} % Sections reference
\newcommand{\Secrefs}[2]{Sections~\ref{#1} and~\ref{#2}} % Sections reference
\newcommand{\secthrurefs}[2]{Sections~\bref{#1}--\bref{#2}} % Sections-- ref.
\newcommand{\Secthrurefs}[2]{Sections~\bref{#1}--\bref{#2}} % Sections-- ref.
\newcommand{\tabref}[1]{Table~\ref{#1}} % Table reference
\newcommand{\Tabref}[1]{Table~\ref{#1}} % Table reference
\newcommand{\tabrefs}[2]{Tables~\ref{#1} and~\ref{#2}} % Tables reference
\newcommand{\Tabrefs}[2]{Tables~\ref{#1} and~\ref{#2}} % Tables reference
\newcommand{\tabthrurefs}[2]{Tables~\bref{#1}--\bref{#2}} % Tables-- ref.
\newcommand{\Tabthrurefs}[2]{Tables~\bref{#1}--\bref{#2}} % Tables-- ref.

%
% Miscellaneous
%
\newcommand{\remark}[1]{\textbf{[Remark: #1]}}
\newcommand{\todo}[1]{\textbf{[#1]}}
\newcommand{\colloq}[1]{``#1''} % colloquialism 
\newcommand{\compfile}[1]{\texttt{#1}}
\newcommand{\compcode}[1]{\texttt{#1}}
\newcommand{\compcom}[1]{\texttt{#1}}
\newcommand{\compin}[1]{\texttt{#1}}
\newcommand{\compout}[1]{\texttt{#1}}

%
% Ions
%
\newcommand{\chemical}[1]{\ensuremath{\mathrm{#1}}} % chemical formulae
\newcommand{\conc}[2]{\ensuremath{ %
    [\mathrm{#1}]_{#2} %
    }} % concentration e.g. \conc{Na}{o} => [Na]_o
\newcommand{\ion}[2]{\ensuremath{\mathrm{{#1}^{#2}}}\xspace} % ion
\newcommand{\ionCa}{\ion{Ca}{2+}} % calcium ion

\newcommand{\ionCl}{\ion{Cl}{-}} % chloride ion
\newcommand{\ionH}{\ion{H}{+}} % hydrogen ion
\newcommand{\ionK}{\ion{K}{+}} % potassium ion
\newcommand{\ionMg}{\ion{Mg}{2+}} % magnessium ion
\newcommand{\ionNa}{\ion{Na}{+}} % sodium ion
\newcommand{\ionphosphate}{\ion{PO_{4}}{3-}} % phosphate ion
\newcommand{\ionbicarbonate}{\ion{HCO_{3}}{-}} % bicarbonate ion

%
% Units
%
\newcommand{\units}[1]{\ensuremath{\mathrm{#1}}\xspace} % units
\newcommand{\nunit}[2]{\ensuremath{ %
    #1~#2 %
    }} % number + unit e.g. \nunit{10}{\m} => 10 m
\newcommand{\nrunit}[3]{\ensuremath{ %
    #1\text{--}#2~#3 %
    }} % number range + unit e.g. \nrunit{10}{20}{\m} => 10--20 m

\newcommand{\mg}{\units{mg}} % milligrams
\newcommand{\g}{\units{g}} % grams
\newcommand{\kg}{\units{kg}} % kilograms
\newcommand{\dB}{\units{dB}} % decibels
\newcommand{\degC}{\units{\degree C}} % degrees Celcius
\newcommand{\kPa}{\units{kPa}} % kilopascals
\newcommand{\MPa}{\units{MPa}} % Megapascals
\newcommand{\GPa}{\units{GPa}} % Gigapascals
\newcommand{\N}{\units{N}} % Newtons
\newcommand{\kN}{\units{kN}} % kilonewtons
\newcommand{\ml}{\units{ml}} % millilitres
%\newcommand{\L}{\units{L}} % litres
\newcommand{\Hz}{\units{Hz}} % Hertz
\newcommand{\kHz}{\units{kHz}} % kilohertz
\newcommand{\MHz}{\units{MHz}} % Megahertz
\newcommand{\nm}{\units{nm}} % nanometres
\newcommand{\um}{\units{\mu m}} % micrometres
\newcommand{\mm}{\units{mm}} % millimetres
\newcommand{\cm}{\units{cm}} % centimetres
\newcommand{\m}{\units{m}} % metres
\newcommand{\A}{\units{A}} % amps
\newcommand{\mA}{\units{mA}} % milliamps
\newcommand{\uA}{\units{\mu A}} % microamps
\newcommand{\nA}{\units{nA}} % nanoamps
\newcommand{\mM}{\units{mM}} % milliMolar
\newcommand{\mmol}{\units{mmol}} % millimolar
\newcommand{\us}{\units{\mu s}} % microseconds
\newcommand{\ms}{\units{ms}} % milliseconds
\newcommand{\s}{\units{s}} % seconds
\newcommand{\uS}{\units{\mu S}} % microSiemens
\newcommand{\mS}{\units{mS}} % milliSiemens
\newcommand{\V}{\units{V}} % volts
\newcommand{\mV}{\units{mV}} % millivolts
\newcommand{\uV}{\units{\mu V}} % micro volts
\newcommand{\ohm}{\units{\Omega}} % Ohms
\newcommand{\mohm}{\units{m\Omega}} % milli Ohms
\newcommand{\percent}{\units{\%}} % percent
\newcommand{\Henrys}{\units{H}} % Henrys
\newcommand{\uF}{\units{\mu F}} %micro-Farads
\newcommand{\kB}{\units{kB}} % kilobyte
\newcommand{\MB}{\units{MB}} % megabyte
\newcommand{\GB}{\units{GB}} % gigabyte

% Derived units
%\newcommand{\unitseparator}{\cdot}
\newcommand{\unitseparator}{\thickspace}

\newcommand{\cmps}{\units{\cm\unitseparator\s^{-1}}} % centimetres/second
\newcommand{\Hpm}{\units{\H\unitseparator\m^{-1}}} % Henrys/metre
\newcommand{\kNpm}{\units{\kN\unitseparator\m^{-1}}} % kilo-Newtons/metre
\newcommand{\Lps}{\units{L\unitseparator\s^{-1}}} % litres/second
\newcommand{\mhom}{\units{\mho\unitseparator\m}} % mho-metres
\newcommand{\mhopm}{\units{\mho\unitseparator\m^{-1}}} % mho/metres
\newcommand{\mps}{\units{\m\unitseparator\s^{-1}}} % metres/second
\newcommand{\msqps}{\units{\m^{2}\unitseparator\s^{-1}}} % metres/second
\newcommand{\mpsps}{\units{\m\unitseparator\s^{-2}}} % metres/(second^2)
\newcommand{\mmps}{\units{\mm\unitseparator\s^{-1}}} % millimetres/second
\newcommand{\mmpms}{\units{\mm\unitseparator\ms^{-1}}} % millimetres/millisecond
\newcommand{\mmtwops}{\units{\mm^{2}\unitseparator\s^{-1}}} % millimetres squared/second
\newcommand{\mtwo}{\units{\m^{2}}} % metres squared
\newcommand{\mmtwo}{\units{\mm^{2}}} % millimetres squared
\newcommand{\mmthree}{\units{\mm^{3}}} % millimetres cubed
\newcommand{\pmetre}{\units{\m^{-1}}} % per meter n.g. \pm is plus-minus
\newcommand{\pcm}{\units{\cm^{-1}}} % per centimeter
\newcommand{\pum}{\units{\um^{-1}}} % per micrometer
\newcommand{\pmm}{\units{\mm^{-1}}} % per millimeter
\newcommand{\pms}{\units{\ms^{-1}}} % per millisecond
\newcommand{\uSpmmpmm}{\units{\uS\unitseparator\mm^{-2}}} % microSiemens per millimeter
\newcommand{\mSpmm}{\units{\mS\unitseparator\mm^{-1}}} % milliSiemens per millimeter
\newcommand{\Spm}{\units{S\unitseparator\m^{-1}}} % Siemens per meter
\newcommand{\Spmm}{\units{S\unitseparator\mm^{-1}}} % Siemens per millimeter
\newcommand{\nApmmpmm}{\units{\nA\unitseparator\mm^{-2}}} % nanoamps per millimeter^2
\newcommand{\uAmm}{\units{\mu A\unitseparator\mm}} % microamps millimeter
\newcommand{\uApmmpmm}{\units{\uA\unitseparator\mm^{-2}}} % microamps per millimeter^2
\newcommand{\uApmmpmmpmm}{\units{\uA\unitseparator\mm^{-3}}} % microamps per millimeter^3
\newcommand{\ohmcm}{\units{\ohm\unitseparator\cm}} % ohm-cm
\newcommand{\uFpmmpmm}{\units{\mu F\unitseparator\mm^{-2}}} %micro-Farads per millimeter squared
\newcommand{\uFpcmpcm}{\units{\mu F\unitseparator\cm^{-2}}} %micro-Farads per centimeter squared
\newcommand{\mmolpL}{\units{\mmol\unitseparator L^{-1}}} %milli-moles per Litre
\newcommand{\mmolpLpms}{\units{\mmol\unitseparator L^{-1}\unitseparator\ms^{-1}}} %milli-moles per Litre per millisecond
\newcommand{\mVpms}{\units{\mV\unitseparator\ms^{-1}}} %microvolts per millisecond
\newcommand{\mgpkg}{\units{\mg\unitseparator\kg^{-1}}} % milligram/kilogram

%
% Base numbers
%
\newcommand{\naturalnums}{\ensuremath{ %
    \mathbb{N} %
  }} % Natural numbers
\newcommand{\integernums}{\ensuremath{ %
    \mathbb{Z} %
  }} % Integer numbers
\newcommand{\realnums}{\ensuremath{ %
    \mathbb{R} %
  }} % Real numbers
\newcommand{\complexnums}{\ensuremath{ %
    \mathbb{C} %
  }} % Complex numbers
\newcommand{\quaternionnums}{\ensuremath{ %
    \mathbb{H} %
  }} % Quaternion numbers
\newcommand{\rationalnums}{\ensuremath{ %
    \mathbb{Q} %
  }} % Rational numbers
\newcommand{\irrationalnums}{\ensuremath{ %
    \mathbb{I} %
  }} % Irrational numbers

%
% Sets
%
\newcommand{\union}[2]{\ensuremath{#1\cup#2}} % Union
\newcommand{\intersection}[2]{\ensuremath{#1\cap#2}} % Intersection

%
% Topologies
%
\newcommand{\rntopology}[1]{\ensuremath{ %
   \ifthenelse{\equal{#1}{}}{ %
      \realnums}{ %
      \realnums^{#1} %
    } %
  }} % R^n (real) topology
\newcommand{\sntopology}[1]{\ensuremath{ %
   \ifthenelse{\equal{#1}{}}{ %
      \mathbb{S}}{ %
      \mathbb{S}^{#1} %
    } %
  }} % S^n (spherical) topology
\newcommand{\dntopology}[1]{\ensuremath{ %
   \ifthenelse{\equal{#1}{}}{ %
      \mathbb{D}}{ %
      \mathbb{D}^{#1} %
    } %
  }} % D^n (discrete) topology

%
% Commonly-used Math Symbols and operations
%
% Products
\newcommand{\dotprod}[2]{\dotprodtwo{#1}{#2}} % dot product
\newcommand{\dotprodtwo}[2]{\ensuremath{#1\cdot#2}} % two times dot product
\newcommand{\dotprodthree}[3]{\ensuremath{#1\cdot#2\cdot#3}} % three times dot product
\newcommand{\doubledotprod}[2]{\doubledotprodtwo{#1}{#2}} % double dot product
\newcommand{\doubledotprodtwo}[2]{\ensuremath{#1:#2}} % two times double dot product
\newcommand{\doubledotprodthree}[3]{\ensuremath{#1:#2:#3}} % three times double double dot product
\newcommand{\crossprod}[2]{\crossprodtwo{#1}{#2}} % cross product
\newcommand{\crossprodtwo}[2]{\ensuremath{#1\times#2}} % two times cross product
\newcommand{\crossprodthree}[3]{\ensuremath{#1\times#2\times#3}} % three times
% cross product
% Brackets
\newcommand{\brac}[3]{\ensuremath{\left#1 #2 \right#3}} % bracket
\newcommand{\pbrac}[1]{\brac{(}{#1}{)}} % parenthesis () bracket
\newcommand{\pbracr}[1]{\brac{(}{#1}{.}} % parenthesis ( bracket
\newcommand{\pbracl}[1]{\brac{.}{#1}{)}} % parenthesis ) bracket
\newcommand{\transpose}[1]{\ensuremath{{#1}^{T}}} % transpose
\newcommand{\abs}[1]{\brac{|}{#1}{|}} % absolute value
\newcommand{\bbrac}[1]{\brac{\{}{#1}{\}}} % Braces { bracket
\newcommand{\conjugate}[1]{\ensuremath{ %
    \overline{#1} %                                _
    }} %% complex conjugate e.g. \conjugate{Z} => Z
\newcommand{\const}[1]{\ensuremath{\mathrm{#1}}} % constant
\newcommand{\cont}[1]{\ensuremath{C^{#1}}} % continuity e.g. \cont{1} => C1
\newcommand{\convolution}[2]{\ensuremath{#1*#2}} % convolution
% e.g. \convolution{a}{b} => a*b
\newcommand{\cuberoot}[1]{\ensuremath{ %
    \sqrt[3]{#1} %
  }} % cube root e.g. \cuberoot{a} = 3\sqrt{a}
\newcommand{\curl}[2]{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\crossprod{\nabla}{#2}}
  }{
    \ensuremath{\crossprod{\nabla_{#1}}{#2}} % 
  }} % curl e.g. \curl{}{a} => nabla x a & \curl{x}{a} => nabla_{x} x a
\newcommand{\degree}{\ensuremath{^{\circ}}\xspace} % degree sign
\newcommand{\del}{\ensuremath{\partial}} % partial derivative sign
\newcommand{\derivativeop}[2]{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\fnof{D}{#2}}
  }{
    \ensuremath{\fnof{D_{#1}}{#2}} % 
  }} % derivative operator e.g. \derivativeop{}{f} => Da & \derivativeop{x}{f} => D_{x}a
\newcommand{\hessianop}[2]{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\fnof{D^{2}}{#2}}
  }{
    \ensuremath{\fnof{D^{2}_{#1}}{#2}} % 
  }} % Hessian operator e.g. \hessianop{}{f} => D^2a & \hessianop{x}{f} => D^{2}_{x}a
\newcommand{\directionalderiv}[3]{\ensuremath{
    \sqfnof{\derivativeop{#1}{#2}}{#3}
}} % directional derivative e.g., \directionalderiv{x}{f}{u} => D_x(f)[u]
\newcommand{\divergence}[2]{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\dotprod{\nabla}{#2}}
  }{
    \ensuremath{\dotprod{\nabla_{#1}}{#2}} % 
  }} % divergence e.g. \divergence{}{a} => nabla . a & \divergence{x}{a} =>
     % nabla_{x} . a
\newcommand{\dint}{\ensuremath{\displaystyle\int}} % display integral
\newcommand{\dintl}[2]{\ensuremath{ %
    \displaystyle\int\limits_{#1}^{#2} %
    }} % display integral with limits
\newcommand{\dotover}[1]{\ensuremath{ %
    \stackrel{\scriptscriptstyle \bullet}{#1} %
    }} % time derivative
\newcommand{\ddotover}[1]{\ensuremath{ %
    \stackrel{\scriptscriptstyle \bullet\bullet}{#1} %
    }} % double time derivative
\newcommand{\dprod}{\ensuremath{\displaystyle\prod}} % display product
\newcommand{\dprodl}[2]{\ensuremath{ %
    \displaystyle\prod_{#1}^{#2} %
    }} % display product with limits
\newcommand{\dsum}{\ensuremath{\displaystyle\sum}} % display summation
\newcommand{\dsuml}[2]{\ensuremath{ %
    \displaystyle\sum_{#1}^{#2} %
    }} % display summation with limits
\newcommand{\evalat}[2]{\ensuremath{ %
    \brac{.}{#1}{|}_{#2} %
    }} % Evaluation at e.g. \evalat{x}{1} => x|_1
\newcommand{\factorial}[1]{\ensuremath{\pbrac{#1}!}} % factorial e.g. \factorial{n} => (n)!
\newcommand{\fnof}[2]{\ensuremath{ %
    #1\brac{(}{#2}{)} %
    }} % function of e.g. \fnof{x}{\xi} => x(xi)
\newcommand{\fntof}[2]{\ensuremath{ %
    \transpose{#1}\brac{(}{#2}{)} %
    }} % function transpose of e.g. \fntof{x}{\xi} => x^T(xi)
\newcommand{\sqfnof}[2]{\ensuremath{ %
    #1\brac{[}{#2}{]} %
    }} % square function of e.g. \fnof{x}{\xi} => x[xi]
\newcommand{\gegenbauer}[3]{\ensuremath{ %
    \fnof{C_{#1}^{#2}}{#3} %
    }} % gegenbauer polynomial e.g. \gengenbauer{1}{2}{x} => C_1^2(x)
\newcommand{\genlimit}[2]{\ensuremath{ %
    \operatornamewithlimits{\lim}_{#1\rightarrow#2}
    }} % general limit e.g. \genlimit{a}{b} => lim a->b
\newcommand{\gint}[4]{\ensuremath{ %
    \dintl{#1}{#2}\,#3\,\exteriorderivop#4 %
    }} % general integral with two limits. e.g.  
       % \gint{a}{b}{xxx}{c} => int_a^b xxx dc
\newcommand{\giint}[7]{\ensuremath{ %
    \dintl{#1}{#2}\!\dintl{#3}{#4}\,#5\,\exteriorderivop#6\wedge\exteriorderivop#7 %
    }} % general double integral with two limits. e.g.  
       % \gint{a}{b}{c}{d}{xxx}{e}{f} => int_a^b int_c^d xxx dedf
\newcommand{\gprod}[3]{\ensuremath{ %
    \dprodl{#1}{#2}\,#3 %
    }} % general product e.g. \gprod{a}{b}{c} => prod_a^b c
\newcommand{\gsum}[3]{\ensuremath{ %
    \dsuml{#1}{#2}\,#3 %
    }} % general sum e.g. \gsum{a}{b}{c} => sum_a^b c
\newcommand{\gssum}[5]{\ensuremath{ %
    \dsuml{#1}{#2}\dsuml{#3}{#4}\,#5 %
    }} % general double sum e.g. \gsum{a}{b}{c}{d}{e} => sum_a^b sum_c^d e
\newcommand{\goneint}[2]{\ensuremath{ %
    \gint{#2}{}{#1}{#2} %
    }} % general integral with one limit. eg. \goneint{xxx}{a} => int_a xxx da
\newcommand{\gonesum}[2]{\ensuremath{ %
    \gsum{#1}{}{#2} %
    }} % general sum with one limit e.g. \gonesum{a}{b} => sum_a b
\newcommand{\grad}{\ensuremath{\nabla}} % gradient
\newcommand{\gradsq}{\ensuremath{\nabla^{2}}} % gradient squared 
\newcommand{\gradient}[2]{ %
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\grad #2}
  }{
    \ensuremath{\grad_{#1} #2} % 
  }} % gradient e.g. \gradient{}{u} => \grad u & \gradient{x}{u} => \grad_{x}
     % u
\newcommand{\functional}[2]{\ensuremath{#1\sqbrac{#2}}} % functional e.g.,
                                % \functional{f}{a} => f[a]
\newcommand{\functionalderiv}[2]{\ensuremath{\delta #1}} % functional deriv e.g.,
                                % \functionalderiv{f} => \delta f
\newcommand{\innerprod}[2]{\ensuremath{ %
    \left<#1,#2\right> %
    }} % inner product e.g. \innerprod{a,b} => <a,b>
\newcommand{\inteval}[3]{\ensuremath{ %
    \displaystyle\sqbrac{#1}_{#2}^{#3} %
    }} % display evaluated integral with limits e.g. 
       % \inteval{xxx}{a}{b} => [xxx]_a^b
\newcommand{\inverse}[1]{\ensuremath{{#1}^{-1}}} % inverse e.g. \inverse{A} => A^-1
\newcommand{\invsquared}[1]{\ensuremath{ %
    {#1}^{-2}
}} % inverse squared e.g. \invsquared{A} => A^-2
\newcommand{\invtranspose}[1]{\ensuremath{ %
    {#1}^{-T}
}} % inverse transpose e.g. \invtranspose{A} => A^-T
\newcommand{\circcomposition}[2]{\ensuremath{ %
    #1\circ#2
}} % composition with circ e.g. \circcomposition{A}{B} => A o 
\newcommand{\funccomposition}[2]{\ensuremath{ %
    \fnof{#1}{#2}
}} % composition with function e.g. \funccomposition{A}{B} => A(B)
\newcommand{\sharpkronecker}[2]{\ensuremath{ %
    \delta^{{#1}{#2}}
}} % sharp kronecker delta tensor e.g., \sharpkronecker{i}{j} => delta^{ij}
\newcommand{\contrakronecker}[2]{\ensuremath{ %
    \sharpkronecker{#1}{#2} %
}} % contravariant kronecker delta tensor e.g., \contrakronecker{i}{j} => delta^{ij}
\newcommand{\flatkronecker}[2]{\ensuremath{
    \delta_{{#1}{#2}}
}} % flat kronecker delta tensor e.g., \flatkronecker{i}{j} => delta_{ij}
\newcommand{\covarkronecker}[2]{\ensuremath{
    \flatkronecker{#1}{#2} %
}} % covariant kronecker delta tensor e.g., \contrakronecker{i}{j} => delta_{ij}
\newcommand{\mixedkronecker}[2]{\ensuremath{
    \delta_{#1}^{#2}
}} % mixed kronecker delta tensor e.g., \mixedkronecker{i}{j} => delta_{i}^{j}
\newcommand{\kronecker}[2]{ %
  \covarkronecker{#1}{#2} %
} % kronecker delta tensor. Default to covariant.
\newcommand{\linearisationdirsymbol}{\ensuremath{ %
    \Delta%
    }} % linearisation direction symbol => \Delta
\newcommand{\linearisationdir}[1]{\ensuremath{ %
    \linearisationdirsymbol #1%
    }} % linerarisation direction e.g. \linearisationdir{f} => \Delta f
\newcommand{\linearisation}[3]{ %
  \ifthenelse{\equal{#2}{}}{ %
    \ensuremath{\sqfnof{\fnof{L}{#1}}{\linearisationdir{#3}}}
  }{
    \ensuremath{\sqfnof{\fnof{L_{#2}}{#1}}{\linearisationdir{#3}}} % 
  }} % linearisation e.g. \linearisation{f}{}{u} => L(f)[\Delta u] &
     % \linearisation{f}{x}{u} => L_x(f)[\Delta u]
\newcommand{\laplacian}[2]{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\gradsq #2}
  }{
    \ensuremath{\gradsq_{#1} #2} % 
  }} % laplacian e.g. \laplacian{}{u} => \nabla^2 u & \laplacian{x}{u} =>
     % \nabla^2_x u
\newcommand{\legendre}[3]{\ensuremath{\fnof{P_{#1}^{#2}}{#3}}} % Legendre polynomial
\newcommand{\liederiv}[2]{\ensuremath{\mathcal{L}_{#1} #2}} % Lie derivative
\newcommand{\limit}[3]{\ensuremath{ %
    \operatornamewithlimits{\lim}_{#1\rightarrow#2} #3 %
    }} % limit e.g. \limit{a}{b}{c} => lim a->b c
\newcommand{\limita}[3]{\ensuremath{ %
    \operatornamewithlimits{\lim}_{#1\downarrow#2} #3 %
    }} % limit from above e.g. \limita{a}{b}{c} => lim a->b c
\newcommand{\limitb}[3]{\ensuremath{ %
    \operatornamewithlimits{\lim}_{#1\uparrow#2} #3 %
    }} % limit from below e.g. \limita{a}{b}{c} => lim a->b c
\newcommand{\lnorm}[2]{\ensuremath{ %
    {\brac{\|}{#2}{\|}_{#1}} %
    }} % l-n norm e.g. \lnorm{x}{3} => ||x||_3
\newcommand{\mapping}[3]{\ensuremath{#1:#2\rightarrow#3}} % mapping
                                % e.g. \mapping{a}{b}{c} => a:b->c
\newcommand{\nth}[1]{\ensuremath{{#1}^{\text{th}}}} % ^th e.g. \nth{n} => n^th
\newcommand{\orderof}[1]{\ensuremath{\fnof{\mathrm{O}}{#1}}} % order e.g. O(n)
\newcommand{\pochhammer}[2]{\ensuremath{ %
    \pbrac{#1}_{#2} %
}} % Pochhammer polynomial e.g. \pochhammer{a}{n} => (a)_n n.b. (a)_n =
% (a,n) where (a,n) is Appell's symbol.
\newcommand{\sphericalharmonic}[4]{\ensuremath{%
    \fnof{Y_{{#1}{#2}}^{#3}}{#4} %
}} % Spherical harmonic e.g. \sphericalharmonic{a}{b}{c}{d} => Y_ab^c(d)
\newcommand{\set}[1]{\ensuremath{
    \bbrac{#1}
}} % e.g. \set{1,2,3} => {1,2,3}
\newcommand{\spaceprod}[2]{\ensuremath{
    #1\times#2 %
}} % space product e.g., \spaceprod{A}{B} => A X B
\newcommand{\sqbrac}[1]{\brac{[}{#1}{]}} % square [ bracket
\newcommand{\symover}[2]{\ensuremath{
    \stackrel{\scriptscriptstyle #1}{#2} %
}} % over
\newcommand{\tento}[1]{\ensuremath{ %
    10^{#1} %
}} % e.g. \tento{3} ten to the power of 3
\newcommand{\ttento}[1]{\ensuremath{ %
    \times \tento{#1} %
    }\xspace} % e.g. \ttento{5} => times ten the power of 5
\newcommand{\nttento}[2]{\ensuremath{ %
    #1\ttento{#2} %
    }} % number times ten to power e.g. \nttento{2}{3} => 2 x 10^3
\newcommand{\variationsymbol}{\ensuremath{ %
    \delta%
    }} % variation symbol => \delta
\newcommand{\variationdir}[1]{\ensuremath{ %
    \variationsymbol #1%
    }} % variation direction e.g. \variationdir{f} => \delta f
\newcommand{\variation}[2]{\ensuremath{ %
    \sqfnof{\variationsymbol #1}{\variationdir{#2}}%
    }} % variation e.g. \variation{f}{u} => \delta f[\delta u]

%
% Operators
% 

% Vector calculus operators
\DeclareMathOperator{\gradop}{grad} % gradient operator e.g., grad A
\DeclareMathOperator{\divop}{div} % divergence operator e.g., div A
\DeclareMathOperator{\curlop}{curl} % curl operator e.g., curl A
\DeclareMathOperator{\Gradop}{Grad} % Gradient operator e.g., Grad A
\DeclareMathOperator{\Divop}{Div} % Divergence operator e.g., Div A
\DeclareMathOperator{\Curlop}{Curl} % Curl operator e.g., Curl A

% Tensor operators
\DeclareMathOperator{\trop}{tr} % trace operator e.g., tr A
\DeclareMathOperator{\Trop}{Tr} % Trace operator e.g., Tr A
\DeclareMathOperator{\adjop}{adj} % adjoint e.g., adj A
\DeclareMathOperator{\symop}{sym} % symmetric operator e.g., sym A
\DeclareMathOperator{\Symop}{Sym} % Symmetric operator e.g., Sym A
\DeclareMathOperator{\skewop}{skw} % skew-symmetric operator e.g., skw A
\DeclareMathOperator{\Skewop}{Skw} % Skew-symmetric operator e.g., Skw A
\DeclareMathOperator{\devop}{dev} % deviatoric operator e.g., dev A
\DeclareMathOperator{\Devop}{Dev} % deviatoric operator e.g., Dev A
\DeclareMathOperator{\sphop}{sph} % spherical operator e.g., sph A
\DeclareMathOperator{\Sphop}{Sph} % Spherical operator e.g., Sph A

%
%  Fractions
%
%\newcommand{\dfrac}[2]{\ensuremath{ %
%    \dfrac{\displaystyle #1}{\displaystyle #2} %
%    }} % display fraction
\newcommand{\dby}[2]{\ensuremath{ %
    \dfrac{ d #1}{d #2} %
    }} % e.g. \dby{u}{v} => d u / d v
\newcommand{\dbyat}[3]{\ensuremath{ %
    \evalat{\dfrac{ d #1}{d #2}}{#3} %
    }} % e.g. \dbyat{u}{v}{a} => d u / d v | _{a}
\newcommand{\Dby}[2]{\ensuremath{ %
    \dfrac{ D #1}{D #2} %
    }} % e.g. \Dby{u}{v} => D u / D v i.e. the full derivative
\newcommand{\dtwoby}[3]{\ensuremath{ %
    \dfrac{ d^{2} #1}{d #2 d #3} %
    }} % e.g. \dtwoby{u}{x}{y} => d^2 u / d x d y
\newcommand{\dtwosqby}[2]{\ensuremath{ %
    \dfrac{ d^{2} #1}{d {#2}^{2}} %
    }} % e.g. \dtwosqby{u}{x} => d^2 u / d x^2
\newcommand{\dthreeby}[4]{\ensuremath{ %
    \dfrac{ d^{3} #1}{d #2 d #3 d #4} %
    }} % e.g. \dthreeby{u}{x}{y}{z} => d^2 u / d x d y d z
\newcommand{\dnby}[3]{\ensuremath{ %
    \dfrac{ d^{#1} #2}{d {#3}^{#1}} %
    }} % e.g. \dnby{3}{u}{v} => d^3 u / d v^3
\newcommand{\dntwoby}[6]{\ensuremath{ %
    \dfrac{ d^{#1} #2}{d {#3}^{#4} d {#5}^{#6}} %
    }} % e.g. \dntwoby{3}{u}{x}{1}{y}{2} => d^3 u / d x d y^2
\newcommand{\delby}[2]{\ensuremath{ %
    \dfrac{\del #1}{\del #2} %
    }} % e.g. \delby{u}{v} => del u / del v
\newcommand{\deltwoby}[3]{\ensuremath{ %
    \dfrac{\del^{2} #1}{\del #2 \del #3} %
    }} % e.g. \delnby{u}{x}{y} => del^2 u / del x del y
\newcommand{\deltwosqby}[2]{\ensuremath{ %
    \dfrac{\del^{2} #1}{\del {#2}^{2}} %
    }} % e.g. \delnby{u}{x} => del^2 u / del x^2
\newcommand{\delthreeby}[4]{\ensuremath{ %
    \dfrac{ \del^{3} #1}{\del #2 \del #3 \del #4} %
    }} % e.g. \delthreeby{u}{x}{y}{z} => del^3 u / del x del y del z
\newcommand{\delthreecuby}[2]{\ensuremath{ %
    \dfrac{ \del^{3} #1}{\del #2^{3}} %
    }} % e.g. \delthreecuby{u}{x} => del^3 u / del x^3
\newcommand{\deldeltwoby}[3]{\ensuremath{ %
    \dfrac{ \del^{3} #1}{\del #2 \del #3^{2}} %
    }} % e.g. \deldeltwoby{u}{x}{y} => del^3 u / del x del y^2
\newcommand{\deltwodelby}[3]{\ensuremath{ %
    \dfrac{ \del^{3} #1}{\del #2^{2} \del #3} %
    }} % e.g. \deltwodelby{u}{x}{y} => del^3 u / del x^2 del y
\newcommand{\delnby}[4]{\ensuremath{ %
    \dfrac{\del^{#1} #2}{\del #3^{#4}} %
    }} % e.g. \delnby{3}{u}{v} => del^3 u / del v^3
\newcommand{\delntwoby}[6]{\ensuremath{ %
    \dfrac{ \del^{#1} #2}{\del {#3}^{#4} \del {#5}^{#6}} %
    }} % e.g. \delntwoby{3}{u}{x}{1}{y}{2} => del^3 u / del x del y^2
\newcommand{\delnthreeby}[8]{\ensuremath{ %
    \dfrac{ \del^{#1} #2}{\del {#3}^{#4} \del {#5}^{#6} \del {#7}^{#8}} %
    }} % e.g. \delnthreeby{5}{u}{x}{1}{y}{2}{z}{2} => del^5 u / del x del y^2 del z^2
\newcommand{\hdby}[2]{ %
  \dby{}{#2}\pbrac{#1} %
  } % horizontal dby e.g. \hdby{u}{x} => d/dx (u)
\newcommand{\hdtwoby}[3]{ %
  \dtwoby{}{#2}{#3}\pbrac{#1} %
  } % horizontal dtwoby e.g. \hdtwoby{u}{x}{y} => d/dxdy (u)
\newcommand{\hdtwosqby}[2]{ %
  \dtwosqby{}{#2}\pbrac{#1} %
  } % horizontal dtwosqby e.g. \hdtwosqby{u}{x} => d^2/dx^2 (u)
\newcommand{\hdthreesqby}[4]{ %
  \dthreeby{}{#2}{#3}{#4}\pbrac{#1} %
  } % horizontal dthreeby e.g. \hdthreeby{u}{x}{y}{z} => d^3/dxdydz (u)
\newcommand{\hdnby}[3]{ %
  \dnby{#1}{}{#3}\pbrac{#2} %
  } % horizontal dnby e.g. \hdnby{3}{u}{x} => d^3/dx^3 (u)
\newcommand{\hdntwoby}[6]{ %
  \dntwoby{#1}{}{#3}{#4}{#5}{#6}\pbrac{#2} %
  } % horizontal dntwoby e.g. \hdntwoby{3}{u}{x}{1}{y}{2} => d^3/dx^1dy^2 (u)
\newcommand{\hdelby}[2]{ %
  \delby{}{#2}\pbrac{#1} %
  } % horizontal delby e.g. \hdelby{u}{x} => del/del x (u)
\newcommand{\hdeltwoby}[3]{ %
  \deltwoby{}{#2}{#3}\pbrac{#1} %
  } % horizontal deltwoby e.g. \hdeltwoby{u}{x}{y} => del/del x del y (u)
\newcommand{\hdeltwosqby}[2]{ %
  \deltwosqby{}{#2}\pbrac{#1} %
  } % horizontal deltwosqby e.g. \hdeltwosqby{u}{x} => del^2/del x^2 (u)
\newcommand{\hdelthreesqby}[4]{ %
  \delthreeby{}{#2}{#3}{#4}\pbrac{#1} %
  } % horizontal delthreeby e.g. \hdelthreeby{u}{x}{y}{z} => 
    % del^3/del x del y del z (u)
\newcommand{\hdelnby}[3]{ %
  \delnby{#1}{}{#3}\pbrac{#2} %
  } % horizontal delnby e.g. \hdelnby{3}{u}{x} => del^3/del x^3 (u)
\newcommand{\hdelntwoby}[6]{ %
  \delntwoby{#1}{}{#3}{#4}{#5}{#6}\pbrac{#2} %
  } % horizontal delntwoby e.g. \hdelntwoby{3}{u}{x}{1}{y}{2} => 
    % del^3/del x^1 del y^2 (u)

%
% Differential Geometry
%
\newcommand{\manifold}[1]{\ensuremath{ %
    \mathfrak{#1} %
}} % manifold symbol
\newcommand{\boundary}[1]{\ensuremath{ %
    \del{#1} %
}} % boundary symbol
\newcommand{\embedmanifold}[1]{\ensuremath{ %
  \mathcal{#1} %
}} % embedded manifold symbol
\newcommand{\connection}[2]{\ensuremath{ %
    \grad_{#1}{#2} %
}} % connection e.g., \connection{X}{Y} => \grad_{X} Y
\newcommand{\coordspacesymbol}{\ensuremath{ %
    \mathcal{C} %
}} % Coordinate space symbol => C
\newcommand{\tangentspacesymbol}{\ensuremath{ %
    \mathcal{T} %
}} % Tangent space symbol => T
\newcommand{\cotangentspacesymbol}{\ensuremath{ %
    \tangentspacesymbol^{*} %
}} % Cotangent space symbol => T^*
\newcommand{\coordspace}[2]{\ensuremath{ %
    \coordspacesymbol_{#2} \manifold{#1} %
}} % Coordinate space e.g., \coordspace{M}{p} => C_p M
\newcommand{\tangentspace}[2]{\ensuremath{ %
    \tangentspacesymbol_{#2} \manifold{#1} %
}} % Tangent space e.g., \tangentspace{M}{p} => T_p M
\newcommand{\cotangentspace}[2]{\ensuremath{ %
    \cotangentspacesymbol_{#2} \manifold{#1} %
}} % Cotangent space e.g., \cotangentspace{M}{p} => T_p^* M
\newcommand{\coordbundle}[1]{\ensuremath{ %
    \coordspacesymbol \manifold{#1} %
}} % Coordinate bundle e.g., \coordbundle{M} => CM
\newcommand{\tangentbundle}[1]{\ensuremath{ %
    \tangentspacesymbol \manifold{#1} %
}} % Tangent bundle e.g., \tangentbundle{M} => TM
\newcommand{\cotangentbundle}[1]{\ensuremath{ %
    \cotangentspacesymbol \manifold{#1} %
}} % Cotangent bundle e.g., \cotangentbundle{M} => T^*M
\newcommand{\pushforward}[2]{\ensuremath{ %
    #1_{*}#2 %
}} % push forward e.g. \pushforward{M}{v} => M_* v
\newcommand{\pullback}[2]{\ensuremath{ %
    #1^{*}#2
}} % pull back e.g., \pullback{M}{v} => M^* v
\newcommand{\christoffel}[3]{ %
  \christoffelsecond{#1}{#2}{#3}
} % Christoffel symbol (defaults to Christoffel symbol of the second kind)
\newcommand{\christoffelfirst}[3]{\ensuremath{ %
    \Gamma_{#1#2#3}
}} % Christoffel symbol of the first kind e.g. \christoffelfirst{i}{j}{k} => Gamma_{ijk}
\newcommand{\christoffelsecond}[3]{\ensuremath{ %
    \Gamma^{#1}_{#2#3}
}} % Christoffel symbol of the second kind e.g. \christoffelsecond{i}{j}{k} => Gamma^{i}_{jk}
\newcommand{\partialderiv}[2]{\ensuremath{
    {#1}_{,#2}
}} % partial derivative. e.g., \partialderiv{i}{j} => i_{,j}
\newcommand{\covarpartialderiv}[2]{\ensuremath{ %
    {#1}_{,#2}
}} % covariant partial derivative e.g. \convarpartialderiv{i}{j} => i_{,j}
\newcommand{\contrapartialderiv}[2]{\ensuremath{ %
    {#1}^{,#2} %
}} % contravariant partial derivative e.g. \contrapartialderiv{i}{j} => i^{,j}
\newcommand{\covarderiv}[2]{\ensuremath{ %
    {#1}_{;#2}
}} % covariant derivative e.g. \covarderiv{i}{j} => i_{;j}
\newcommand{\covarderivop}[2]{%
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\nabla{#2}}
  }{
    \ensuremath{\nabla_{#1}{#2}} % 
  }} % covariant derivative operator e.g. \covarderivop{x}{y} => \nabla_{x}y
\newcommand{\doublecovarderivop}[2]{%
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\nabla^{2}{#2}}
  }{
    \ensuremath{\nabla^{2}_{#1}{#2}} % 
}} % double covariant derivative operator e.g. \doublecovarderivop{x}{y} => \nabla^{2}_{x}y
\newcommand{\mixedderiv}[3]{\ensuremath{ %
    \brac{.}{#1}{|}^{#2}_{#3}
}} % mixed derivative e.g. \mixedderiv{i}{j}{k} => i | ^{j}_{k}
\newcommand{\exteriorderivop}[0]{\ensuremath{ %
    \boldsymbol{\mathrm{d}}
  }} % Exterior derivative operator e.g., \exteriorderivop => d7
\newcommand{\exteriorderiv}[1]{\ensuremath{ %
    \exteriorderivop#1
  }} % Exterior derivative e.g., \exteriorderiv{a} => da
\newcommand{\sharptensor}[1]{\ensuremath{ %
    #1^{\sharp}
}} % sharp tensor e.g.,\sharptensor{A} => A^#
\newcommand{\flattensor}[1]{\ensuremath{#1^{\flat}}} % flat tensor e.g.,
                                % \flattensor{A} => A^b
% cpb 19/9/96 Changing from \mathbf to \boldsymbol to allow bold greek tensors
%\newcommand{\tensor}[1]{\ensuremath{\mathbf{#1}}} % tensor
\newcommand{\vectr}[1]{\ensuremath{\boldsymbol{#1}}} % vector
\newcommand{\covectr}[1]{\ensuremath{\boldsymbol{#1}}} % covector
\newcommand{\tensortwo}[1]{\ensuremath{\boldsymbol{\mathit{#1}}}} % 2nd order tensor
\newcommand{\tensorthree}[1]{\ensuremath{\boldsymbol{\mathrm{#1}}}} % 3rd order tensor
\newcommand{\tensorfour}[1]{\ensuremath{\boldsymbol{\mathsf{#1}}}} % 4th order tensor
\newcommand{\tensor}[1]{\tensortwo{#1}} % tensor
\newcommand{\covartensor}[3]{\ensuremath{{#1}_{#2#3}}} % covariant tensor
\newcommand{\contratensor}[3]{\ensuremath{{#1}^{#2#3}}} % contravariant tensor
\newcommand{\mixedtensor}[3]{\ensuremath{{#1}_{#2}^{#3}}} % mixed tensor
\newcommand{\tensorprod}[2]{ %
  \tensorprodtwo{#1}{#2} %
} % tensor product e.g., \tensorprod{a}{b} => a Ox b.
\newcommand{\tensorprodtwo}[2]{\ensuremath{ %
    #1 \otimes #2 %
}} % tensor product two e.g., \tensorprodtwo{a}{b} => a Ox b.
\newcommand{\tensorprodfour}[4]{\ensuremath{ %
    #1 \otimes #2 \otimes #3 \otimes #4 %
}} % tensor product four e.g., \tensorprodfour{a}{b}{c}{d} => a Ox b Ox c Ox d.
\newcommand{\symtensorprod}[2]{ %
  \symtensorprodtwo{#1}{#2} %
} % symmetric tensor product e.g., \symtensorprod{a}{b} => a O. b.
\newcommand{\symtensorprodtwo}[2]{\ensuremath{ %
    #1 \odot #2 %
}} % symmetric tensor product two e.g., \symtensorprodtwo{a}{b} => a O. b.
\newcommand{\symtensorprodfour}[4]{\ensuremath{ %
    #1 \odot #2 \odot #3 \odot #4 %
}} % symmetric tensor product four e.g., \symtensorprodfour{a}{b}{c}{d} => a
% O. b O. c O. d.
\newcommand{\wedgeprod}[2]{\ensuremath{ %
    #1 \wedge #2 %
}} % wedge product e.g., \wedgeprod{a}{b} => a^b.
\newcommand{\exteriorprod}[2]{\ensuremath{ %
    \wedgeproduct{#1}{#2} %
}} % exterior product e.g., \exteriorprod{a}{b} => a^b.

%
% Matrices and vectors
%
% cpb 19/9/96 Changing from \mathbf to \boldsymbol to allow bold greek matrices
%\newcommand{\matr}[1]{\ensuremath{\uppercase{\mathbf{#1}}}} % matrix
\newcommand{\matr}[1]{\ensuremath{\uppercase{\boldsymbol{#1}}}} % matrix
% cpb 19/9/96 Changing from \mathbf to \boldsymbol to allow bold greek vectors
\newcommand{\vect}[1]{\ensuremath{\lowercase{\boldsymbol{#1}}}} % vector
\newcommand{\normal}{\vectr{n}} % normal

% Matrix and vector operators
\newcommand{\determinant}[1]{\det #1} % determinant e.g., \determinant{A} =
                                % det A
\newcommand{\deviatoric}[2]{\ensuremath{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\devop #2}%
  }{
    \ensuremath{\devop_{#1} #2}% 
  }
}} % deviatoric operator e.g., \deviatoric{g}{A} = dev_g A where g is the optional metric
   % for the deviatoric operator
\newcommand{\Deviatorc}[2]{\ensuremath{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\Devop #2}%
  }{
    \ensuremath{\Devop_{#1} #2}% 
  }
}} % deviatoric operator e.g., \Deviatoric{g}{A} = Dev_g A where g is the optional metric
   % for the deviatoric operator
\newcommand{\norm}[1]{\lnorm{2}{#1}} % normalise i.e. l-2 norm
\newcommand{\skewsym}[1]{\ensuremath{
    \skewop #1 % skew-symmetric operator i.e., \skewsym{A} = skw A
  }}
\newcommand{\Skewsym}[1]{\ensuremath{
    \Skewop #1 % skew-symmetric operator i.e., \Skewsym{A} = Skw A
  }}
\newcommand{\spherical}[2]{\ensuremath{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\sphop #2}%
  }{
    \ensuremath{\sphop_{#1} #2}% 
  }
}} % spherical oeprator e.g., \spherical{g}{A} = sph_g A where g is the optional metric
   % for the spherical operator
\newcommand{\Spherical}[2]{\ensuremath{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\Sphop #2}%
  }{
    \ensuremath{\Sphop_{#1} #2}% 
  }
}} % spherical operator e.g., \Spherical{g}{A} = Sph_g A where g is the optional metric
   % for the spherical operator
\newcommand{\symmetric}[1]{\ensuremath{
    \symop #1 % symmetric operator i.e., \symmetric{A} = sym A
  }}
\newcommand{\Symmetric}[1]{\ensuremath{
    \Symop #1 % symmetric operator i.e., \Symmetric{A} = Sym A
  }}
\newcommand{\trace}[2]{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\trop #2}
  }{
    \ensuremath{\trop_{#1} #2} % 
  }
} % trace e.g., \trace{g}{A} = tr_g A where g is the optional metric for the trace
\newcommand{\Trace}[2]{
  \ifthenelse{\equal{#1}{}}{ %
    \ensuremath{\Trop #2}
  }{
    \ensuremath{\Trop_{#1} #2} % 
  }
} % Trace e.g., \Trace{G}{A} = Tr_G A where G is the optional metric for the trace

%
% Basis functions and interpolation
%
\newcommand{\nodept}[2]{\ensuremath{ %
    {#1}^{#2} %
  }} % Nodal point (without derivative) e.g., \nodept{\psi}{n}=> nodal dof of \psi at node n.
\newcommand{\nodedof}[3]{\ensuremath{ %
  \nodept{#1}{#2}_{,#3} %
}} % Nodal DOF e.g., \nodedof{\psi}{n}{u} => nodal dof of \psi at node n
  % derivative u.
\newcommand{\idxnodedof}[4]{\ensuremath{ %
  \nodept{#1}{#3}_{#2,#4} %
}} % Indexed nodal DOF e.g., \nodedof{\psi}{i}{n}{u} => nodal dof of ith
   % component of \psi at node n derivative u.
\newcommand{\uidxnodedof}[4]{\ensuremath{ %
  \nodept{#1}{#2#3}_{,#4} %
}} % "Upper" Indexed nodal DOF e.g., \nodedof{\psi}{i}{n}{u} => nodal dof of ith
   % component of \psi at node n derivative u.
\newcommand{\elementdof}[2]{\ensuremath{ %
  #1_{#2} %
}} % Element DOF e.g., \elementdof{\psi}{e} => element dof of \psi at element e
\newcommand{\chbfnsymb}[2]{\ensuremath{ %
    \Psi_{#1}^{#2} %
    }} % Cubic Hermite basis function symbol
\newcommand{\chbfn}[3]{\ensuremath{ %
    \fnof{\chbfnsymb{#1}{#2}}{#3} %
    }} % \chbfn{n}{u}{xi} => cubic Hermite basis function at node n deriv u
       % evaluated at xi
\newcommand{\hsonebfnsymb}[1]{\ensuremath{ %
    \zeta_{#1} %
    }} % Hermite sector 1 basis function symbol
\newcommand{\hsonebfn}[2]{\ensuremath{ %
    \fnof{\hsonebfnsymb{#1}}{#2} %
    }} % \hsonebfn{n}{xi} => Hermite sector 1 basis function at node n
       % evaluated at xi
\newcommand{\hsthreebfnsymb}[1]{\ensuremath{ %
    \eta_{#1} %
    }} % Hermite sector 3 basis function symbol
\newcommand{\hsthreebfn}[2]{\ensuremath{ %
    \fnof{\hsthreebfnsymb{#1}}{#2} %
    }} % \hsonebfn{n}{xi} => Hermite sector 3 basis function at node n
       % evaluated at xi
\newcommand{\lbfnsymb}[1]{\ensuremath{ %
    \varphi_{#1} %
    }} % Lagrange basis function symbol
\newcommand{\lbfn}[2]{\ensuremath{ %
    \fnof{\lbfnsymb{#1}}{#2} %
    }} % \lbfn{n}{xi} => Lagrange basis function at node n evaluated at xi
\newcommand{\sbfnsymb}[1]{\ensuremath{ %
    N_{#1} %
  }} % Simplex basis function symbol
\newcommand{\sbfn}[2]{\ensuremath{ %
    \fnof{\sbfnsymb{#1}}{#2} %
    }} % \sbfn{n}{xi} => Simplex basis function at node n evaluated at xi
\newcommand{\gbfnsymb}[2]{\ensuremath{ %
    \psi_{#1}^{#2} %
    }} % Generic basis function symbol
\newcommand{\altgbfnsymb}[2]{\ensuremath{ %
    \phi_{#1}^{#2} %
    }} % Alternate generic basis function symbol
\newcommand{\idxgbfnsymb}[3]{\ensuremath{ %
    \psi_{#1#2}^{#3} %
    }} % Indexed generic basis function symbol
\newcommand{\altidxgbfnsymb}[3]{\ensuremath{ %
    \phi_{#1#2}^{#3} %
    }} % Alternate indexed generic basis function symbol
\newcommand{\uidxgbfnsymb}[3]{\ensuremath{ %
    \psi_{#2}^{#1#3} %
    }} % "Upper" indexed generic basis function symbol
\newcommand{\altuidxgbfnsymb}[3]{\ensuremath{ %
    \phi_{#2}^{#1#3} %
    }} % Alternate "Upper" indexed generic basis function symbol
\newcommand{\gbfn}[3]{\ensuremath{ %
    \fnof{\gbfnsymb{#1}{#2}}{#3} %
    }} % \gbfn{n}{i}{xi} => Generic bais function at n,i evaluated at xi
\newcommand{\altgbfn}[3]{\ensuremath{ %
    \fnof{\altgbfnsymb{#1}{#2}}{#3} %
    }} % \altgbfn{n}{i}{xi} => Alternate generic bais function at n,i evaluated at xi
\newcommand{\idxgbfn}[4]{\ensuremath{ %
    \fnof{\idxgbfnsymb{#1}{#2}{#3}}{#4} %
    }} % \idxgbfn{j}{n}{i}{xi} => Indexed j'th generic bais function at n,i evaluated at xi
\newcommand{\altidxgbfn}[4]{\ensuremath{ %
    \fnof{\altidxgbfnsymb{#1}{#2}{#3}}{#4} %
    }} % \altidxgbfn{j}{n}{i}{xi} => Alternate indexed j'th generic bais function at n,i evaluated at xi
\newcommand{\uidxgbfn}[4]{\ensuremath{ %
    \fnof{\uidxgbfnsymb{#1}{#2}{#3}}{#4} %
    }} % \uidxbfn{j}{n}{i}{xi} => "Upper" indexed j'th generic bais function at n,i evaluated at xi
\newcommand{\altuidxgbfn}[4]{\ensuremath{ %
    \fnof{\altuidxgbfnsymb{#1}{#2}{#3}}{#4} %
    }} % \altuidxbfn{j}{n}{i}{xi} => Alternate "Upper" indexed j'th generic bais function at n,i evaluated at xi
\newcommand{\esfsymb}{\ensuremath{ %
    S %
    }} % Element scale factor symbol
\newcommand{\esfone}[1]{\ensuremath{ %
    \fnof{\esfsymb}{{#1}} %
    }} % \esfone{e} => Element scale factor in one direction in element e
\newcommand{\esftwo}[2]{\ensuremath{ %
    \fnof{\esfsymb}{#1,#2} %
    }} % \esftwo{e}{i} => Element scale factor in two directions in element e
       % and xi direction i
\newcommand{\gsfsymb}{\ensuremath{ %
    \mathrm{S} %
    }} % Generic scale factor symbol
\newcommand{\gsf}[2]{\ensuremath{ %
    \fnof{\gsfsymb}{#1,#2} %
    }} % \gsf{n}{i} => Generic scale factor in at position n,i
\newcommand{\idxgsf}[3]{\ensuremath{ %
    \fnof{\gsfsymb}{#1,#2,#3} %
    }} % \gsf{j}{n}{i} => Generic scale factor in at position n,i for the j'th
       % component idx
\newcommand{\nsfsymb}{\ensuremath{ %
    \mathcal{S} %
    }} % Nodal scale factor symbol
\newcommand{\nsfone}[1]{\ensuremath{ %
    \fnof{\nsfsymb}{#1} %
    }} % \nsfone{n} => Nodal scale factor in one direction at node n
\newcommand{\nsftwo}[2]{\ensuremath{ %
    \fnof{\nsfsymb}{#1,#2} %
    }} % \nsftwo{n}{i} => Nodal scale factor in two directions at node n and xi
       % direction i
\newcommand{\xione}{\ensuremath{\xi_{1}}\xspace} % xi 1
\newcommand{\xitwo}{\ensuremath{\xi_{2}}\xspace} % xi 2
\newcommand{\xithree}{\ensuremath{\xi_{3}}\xspace} % xi 3


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
